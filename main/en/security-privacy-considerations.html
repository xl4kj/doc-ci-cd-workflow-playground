<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Security and Privacy Considerations &#8212; IT-Wallet Technical Specification c  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/basic_mod.css?v=9b2032db" />
    <link rel="stylesheet" type="text/css" href="_static/itwallet-override.css?v=63798874" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <script src="_static/js/petite-vue.js"></script>
    <link rel="icon" href="https://avatars.githubusercontent.com/u/15377824?s=48&amp;v=4"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="General Log Retention Policies" href="log-retention-policy.html" />
    <link rel="prev" title="Cryptographic Algorithms" href="algorithms.html" /> 
  </head><body data-dark_mode_code_blocks="true">

<div id="top_nav">
    

    <nav>
        
            
        

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="index.html" title="Go to homepage">IT-Wallet Technical Specification c  documentation</a></h1>
            <a id="source_link" href="https://github.com/italia/eudi-wallet-it-docs">
    
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
            <path fill="white" d="M 244.8,8 C 106.1,8 0,113.3 0,252 c 0,110.9 69.8,205.8 169.5,239.2 12.8,2.3 17.3,-5.6 17.3,-12.1 0,-6.2 -0.3,-40.4 -0.3,-61.4 0,0 -70,15 -84.7,-29.8 0,0 -11.4,-29.1 -27.8,-36.6 0,0 -22.9,-15.7 1.6,-15.4 0,0 24.9,2 38.6,25.8 21.9,38.6 58.6,27.5 72.9,20.9 2.3,-16 8.8,-27.1 16,-33.7 -55.9,-6.2 -112.3,-14.3 -112.3,-110.5 0,-27.5 7.6,-41.3 23.6,-58.9 -2.6,-6.5 -11.1,-33.3 2.6,-67.9 20.9,-6.5 69,27 69,27 20,-5.6 41.5,-8.5 62.8,-8.5 21.3,0 42.8,2.9 62.8,8.5 0,0 48.1,-33.6 69,-27 13.7,34.7 5.2,61.4 2.6,67.9 16,17.7 25.8,31.5 25.8,58.9 0,96.5 -58.9,104.2 -114.8,110.5 9.2,7.9 17,22.9 17,46.4 0,33.7 -0.3,75.4 -0.3,83.6 0,6.5 4.6,14.4 17.3,12.1 C 428.2,457.8 496,362.9 496,252 496,113.3 383.5,8 244.8,8 Z"/>
        </svg>
    
</a>
        

        <a id="mode_toggle" href="#" @click.prevent="handleClick" :title="mode">
    <template v-if="mode == 'light'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_light"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M67.48,18.073c1.913,-1.912 1.913,-5.018 0,-6.931c-1.912,-1.912 -5.018,-1.912 -6.931,0l-6.798,6.799c-1.912,1.912 -1.912,5.018 0,6.931c1.913,1.912 5.018,1.912 6.931,-0l6.798,-6.799Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.728,61.108c1.912,-1.913 1.912,-5.018 -0,-6.931c-1.913,-1.913 -5.019,-1.913 -6.931,-0l-6.799,6.798c-1.912,1.913 -1.912,5.019 0,6.931c1.913,1.913 5.019,1.913 6.931,0l6.799,-6.798Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.682,54.177c-1.913,-1.913 -5.018,-1.913 -6.931,-0c-1.912,1.913 -1.912,5.018 0,6.931l6.798,6.798c1.913,1.913 5.019,1.913 6.931,0c1.913,-1.912 1.913,-5.018 0,-6.931l-6.798,-6.798Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M4.901,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,-0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M18.929,11.142c-1.912,-1.912 -5.018,-1.912 -6.931,0c-1.912,1.913 -1.912,5.019 0,6.931l6.799,6.799c1.912,1.912 5.018,1.912 6.931,-0c1.912,-1.913 1.912,-5.019 -0,-6.931l-6.799,-6.799Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.108,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c-0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c-0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'dark'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_dark"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.901,2.196 -4.901,4.901c0,2.705 2.197,4.901 4.901,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.662,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.989,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.732,61.103c1.91,-1.91 1.91,-5.011 0,-6.921l-0.009,-0.01c-1.91,-1.91 -5.012,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.909,1.91 5.011,1.91 6.92,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.672,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.52,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l-0,-0.01c-0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.901,2.196 -4.901,4.901c0,2.704 2.197,4.9 4.901,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.73,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 -0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.098,34.623c-2.699,0 -4.891,2.192 -4.891,4.892l-0,0.019c-0,2.699 2.192,4.891 4.891,4.891c2.7,0 4.892,-2.192 4.892,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.892,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'darkest'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_darkest"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><path d="M39.315,23.791c8.684,-0 15.734,7.05 15.734,15.733c0,8.684 -7.05,15.734 -15.734,15.734c-8.683,0 -15.733,-7.05 -15.733,-15.734c-0,-8.683 7.05,-15.733 15.733,-15.733Zm0,4.737c6.069,0 10.997,4.927 10.997,10.996c-0,6.069 -4.928,10.996 -10.997,10.996c-6.068,0 -10.996,-4.927 -10.996,-10.996c0,-6.069 4.928,-10.996 10.996,-10.996Z" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.216,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.9,2.196 -4.9,4.901c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.666,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.99,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.737,61.103c1.909,-1.91 1.909,-5.011 -0,-6.921l-0.01,-0.01c-1.91,-1.91 -5.011,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.91,1.91 5.011,1.91 6.921,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.676,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.524,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l0,-0.01c0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.216,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901c-0,2.704 2.196,4.9 4.9,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.734,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.103,34.623c-2.7,0 -4.892,2.192 -4.892,4.892l-0,0.019c-0,2.699 2.192,4.891 4.892,4.891c2.699,0 4.891,-2.192 4.891,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.891,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>
</a>

<script>
(function() {
    const LOCAL_STORAGE_KEY = 'piccoloThemeMode'

    var initialMode = localStorage.getItem(LOCAL_STORAGE_KEY)

    if (initialMode) {
        // Make sure the value in local storage is valid
        if (['light', 'dark', 'darkest'].indexOf(initialMode) == -1) {
            initialMode = 'light'
            localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
        }
    } else {
        // Check if the client prefers dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            initialMode = 'dark'
        } else {
            initialMode = 'light'
        }
        localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
    }

    document.documentElement.dataset.mode = initialMode

    PetiteVue.createApp({
        'mode': initialMode,
        handleClick() {
            let currentMode = this.mode

            if (currentMode == 'light') {
                this.mode = 'dark'
            } else if (currentMode == 'dark') {
                this.mode = 'darkest'
            } else if (currentMode == 'darkest') {
                this.mode = 'light'
            }

            document.documentElement.dataset.mode = this.mode
            localStorage.setItem(LOCAL_STORAGE_KEY, this.mode)

            console.log(this.mode)
        }
    }).mount('#mode_toggle')
})()
</script>
            <p class="mobile_search_link">
                <a href="search.html" title="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 64" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2">
                        <path d="M14.873 40.009c-2.315-3.943-3.642-8.532-3.642-13.429C11.231 11.91 23.141 0 37.811 0s26.58 11.91 26.58 26.58-11.91 26.58-26.58 26.58a26.44 26.44 0 0 1-14.277-4.161L9.739 62.794a3.12 3.12 0 0 1-4.413 0L.913 58.382c-1.217-1.218-1.217-3.196 0-4.413l13.96-13.96zM37.811 8.054c10.225 0 18.526 8.301 18.526 18.526s-8.301 18.526-18.526 18.526-18.526-8.301-18.526-18.526S27.586 8.054 37.811 8.054z" fill="#fff" />
                    </svg>
                </a>
            </p>
        

        <div class="searchbox_wrapper">
            
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
    </nav>
</div>

    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="defined-terms.html">Normative References</a></li>
<li class="toctree-l1"><a class="reference internal" href="defined-terms.html#defined-terms-and-acronyms">Defined Terms and Acronyms</a></li>
<li class="toctree-l1"><a class="reference internal" href="defined-terms.html#normative-language-and-conventions">Normative Language and Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ssi-introduction.html">The Digital Identity Wallet Paradigm</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html#it-wallet-system-brand-identity">IT-Wallet System Brand Identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html#functionalities">Functionalities</a></li>
<li class="toctree-l1"><a class="reference internal" href="trust.html">The Infrastructure of Trust</a></li>
<li class="toctree-l1"><a class="reference internal" href="wallet-solution.html">Wallet Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="issuer-solution.html">Issuer Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="relying-party-solution.html">Relying Party Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="pid-eaa-data-model.html">PID/(Q)EAA Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="registry-catalogue.html">Digital Credentials Catalogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="pid-eaa-issuance.html">PID/(Q)EAA Issuance</a></li>
<li class="toctree-l1"><a class="reference internal" href="pid-eaa-presentation.html">PID/(Q)EAA Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="credential-revocation.html">Digital Credential Lifecycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="authentic-sources.html">Authentic Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="backup-restore.html">Backup and Restore</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Cryptographic Algorithms</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Security and Privacy Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="log-retention-policy.html">General Log Retention Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="standards.html">Technical References</a></li>
<li class="toctree-l1"><a class="reference internal" href="test-plans.html">Test Plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="open-source.html">Open Source Releases for IT-Wallet Solutions</a></li>
</ul>

        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="security-and-privacy-considerations">
<span id="security-privacy-considerations-rst"></span><h1>Security and Privacy Considerations<a class="headerlink" href="#security-and-privacy-considerations" title="Link to this heading">¶</a></h1>
<p>This section provides an informal security analysis of the IT-Wallet specification by analyzing the compliance with the security and privacy requirements identified in [<a class="reference external" href="https://openid.github.io/OpenID4VC_SecTrust/draft-oid4vc-security-and-trust.html">OpenID4VC-SecTrust</a>].</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As [<a class="reference external" href="https://openid.github.io/OpenID4VC_SecTrust/draft-oid4vc-security-and-trust.html">OpenID4VC-SecTrust</a>] is still a work in progress, the security and privacy considerations described may change in the future.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The focus of the analysis is the compliance of the design choices in the IT-Wallet specification with respect to the OpenID4VC protocols.
It is currently out-of-scope <em>(i)</em> the analysis of the design of the proximity flow based on ISO 18013-5, and <em>(ii)</em> the analysis of the implementation;
as a consequence 7 requirements specifically related to the implementation are not considered (e.g., SV-00: The Verifier must implement the protocol securely and correctly).</p>
</div>
<p>As in [<a class="reference external" href="https://openid.github.io/OpenID4VC_SecTrust/draft-oid4vc-security-and-trust.html">OpenID4VC-SecTrust</a>], all requirements are numbered for reference. Together with the respective component that needs to implement the requirement:</p>
<ul class="simple">
<li><p><strong>CF</strong>: Credential Format;</p></li>
<li><p><strong>P</strong>: Protocol;</p></li>
<li><p><strong>E</strong>: Ecosystem;</p></li>
<li><p><strong>I</strong>: Issuer;</p></li>
<li><p><strong>V</strong>: Verifier;</p></li>
<li><p><strong>W</strong>: Wallet.</p></li>
</ul>
<p>This specification adds the requirement category as a prefix:</p>
<ul class="simple">
<li><p><strong>SR</strong>: Security Requirements;</p></li>
<li><p><strong>PR</strong>: Privacy Requirements;</p></li>
<li><p><strong>SPR</strong>: Security and Privacy Requirements.</p></li>
</ul>
<p>The final identifier uses the following name space: <em>requirement_category-component-id</em>.</p>
<p>For each requirement defined below, this section uses the description defined in [<a class="reference external" href="https://openid.github.io/OpenID4VC_SecTrust/draft-oid4vc-security-and-trust.html">OpenID4VC-SecTrust</a>], specifying whether the requirement is satisfied (fully satisfied: <a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a>, partially satisfied: <a class="reference internal" href="_images/Eo_circle_orange_checkmark.svg"><img alt="partially-check-icon" src="_images/Eo_circle_orange_checkmark.svg" style="width: 25px;" /></a>, and not satisfied: <a class="reference internal" href="_images/Eo_circle_red_letter-x.svg"><img alt="uncheck-icon" src="_images/Eo_circle_red_letter-x.svg" style="width: 25px;" /></a>).
In the following, the requirements are grouped based on their category.</p>
<section id="security-requirements">
<h2>Security Requirements<a class="headerlink" href="#security-requirements" title="Link to this heading">¶</a></h2>
<section id="sr-cf-10-and-sr-e-10">
<h3>SR-CF-10 and SR-E-10<a class="headerlink" href="#sr-cf-10-and-sr-e-10" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>For any presentation, the Credential format and Trust Framework must be designed in a secure way to determine the Issuer and to check that the original Credential was issued by this Issuer (e.g., by using a cryptographic signature).</p></td>
</tr>
</tbody>
</table>
<p>The IT-Wallet specification supports both SD-JWT-VC and mdoc-CBOR Credential formats. The authenticity and integrity of a Credential is checked by verifying the Issuer's signature.</p>
<ul class="simple">
<li><p>For SD-JWT, the verification is performed using the algorithm specified in the <strong>alg</strong> header parameter of SD-JWT and a verifiable reference to the public key that must be used for the signature verification. Using OpenID Federation, the verifiable reference to the public cryptographic material is the <strong>kid</strong> header of the SD-JWT, where the cryptographic material is obtained from the Trust Chain about the Credential Issuer, specified in <strong>iss</strong> claim.</p></li>
<li><p>For mdoc-CBOR, the Issuer's signature is contained in the <em>Mobile Security Object</em> (MSO) and must be validated using the Issuer's public key through a trusted certificate chain contained in the <strong>x5chain</strong> header parameter.</p></li>
</ul>
</section>
<section id="sr-cf-20">
<h3>SR-CF-20<a class="headerlink" href="#sr-cf-20" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>For any presentation, the Credential format must ensure that the data that is tied to the original Credential cannot be altered (e.g., by using a cryptographic signature.)</p></td>
</tr>
</tbody>
</table>
<p>The cryptographic signature included in the Credential format ensures that any tampering with the Credential will result in a failed verification.</p>
</section>
<section id="sr-cf-21">
<h3>SR-CF-21<a class="headerlink" href="#sr-cf-21" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>For cryptographic Holder binding, the presentation format requires the Holder to demonstrate possession of the private key associated with the Credential. This is typically achieved by having the Holder sign a challenge, which consists of a nonce value and the Verifier's unique identifier.</p></td>
</tr>
</tbody>
</table>
<p>Both SD-JWT and mdoc-CBOR support cryptographic Holder binding by defining how a Holder can present a Credential to a Verifier, providing cryptographic proof of legitimate possession of the Credential.</p>
<p>Currently, for the remote flow, IT-Wallet supports only SD-JWT presentations. In this scenario, the KB-JWT (Key-Bound JWT) parameter is utilized to demonstrate that the Holder possesses the private key associated with the Credential. The Holder signs the KB-JWT using a <strong>nonce</strong> and a Verifier identifier, using the <strong>aud</strong> parameter, as a challenge.</p>
</section>
<section id="sr-e-20">
<h3>SR-E-20<a class="headerlink" href="#sr-e-20" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Trust Framework must ensure that the identification of an Issuer is unique and unambiguous. If there are multiple instances of the same Issuer using the same key material, the Verifier must trust all instances equally.</p></td>
</tr>
</tbody>
</table>
<p>The IT Wallet Trust Framework ensures that each entity (e.g., an Issuer) is uniquely identified through cryptographic
keys and metadata, as distributed via a verifiable attestation, such as the OpenID Federation Entity Configuration verified within a Trust Chain.</p>
</section>
<section id="sr-e-30">
<h3>SR-E-30<a class="headerlink" href="#sr-e-30" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The way in which the Verifier determines the trustworthiness of the Issuer defined in the Trust Framework must be secured from influence by a malicious party that can, for example, introduce untrustworthy entities into a directory.</p></td>
</tr>
</tbody>
</table>
<p>Issuers are registered by a Trust Anchor or its Intermediate. To verify the trust of an Issuer, a Verifier must verify that the Trust Chain related to the Issuer is valid and still active. This validation process ensures that only trusted entities are permitted to participate in the system, preventing the introduction of untrustworthy actors.</p>
</section>
<section id="sr-e-40">
<h3>SR-E-40<a class="headerlink" href="#sr-e-40" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Trust Framework must ensure that there is a way for Verifiers to keep their information on trusted Issuers up to date and that there is a way to revoke trust in an Issuer.</p></td>
</tr>
</tbody>
</table>
<p>If an Issuer's Entity Statement is revoked or unavailable, means that Issuer is no longer considered valid within the federation. This ensures that Verifiers have real-time access to the status of trusted entities and can revoke trust if necessary. However, Verifiers must actively check the Issuer's status by querying federation endpoints (i.e., the fetch endpoint for obtaining the Subordinate Statement).</p>
</section>
<section id="sr-i-10">
<h3>SR-I-10<a class="headerlink" href="#sr-i-10" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Issuer must authenticate and identify the User properly according to the expectations of the Verifier (which may be defined in a specification, Trust Framework, or by convention).</p></td>
</tr>
</tbody>
</table>
<p>The issuance process utilizes OAuth 2.0-based flows, specifically the Authorization Code Flow, to securely authenticate the User. Moreover, the User authentication is performed using CieID scheme with high LoA or the PID.</p>
</section>
<section id="sr-i-20">
<h3>SR-I-20<a class="headerlink" href="#sr-i-20" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Issuer must only use correct and up-to-date claims about the User into the Credential where verified data is expected.</p></td>
</tr>
</tbody>
</table>
<p>When verified data is expected, the Issuer obtains the correct and up-to-date claims from the relevant Authentic Sources, ensuring their accuracy at the time of issuance.</p>
</section>
<section id="sr-i-30">
<h3>SR-I-30<a class="headerlink" href="#sr-i-30" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Issuer must revoke a Credential once the Issuer learns about potential abuse of the Credential.</p></td>
</tr>
</tbody>
</table>
<p>The Issuer is the entity responsible for revoking a Credential. The specification describes several use cases that may trigger a revocation process and details the revocation flow in which the Issuer revokes Credentials at the User's request (through the Wallet Instance) after verifying possession of the Credentials.</p>
</section>
<section id="sr-i-40">
<h3>SR-I-40<a class="headerlink" href="#sr-i-40" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Issuer must only include Holder-binding data into the Credential that is tied to the actual User (and not, e.g., include a cryptographic key under control by a third party).</p></td>
</tr>
</tbody>
</table>
<p>The issuance process securely binds the Credential to the User as follows (see <a class="reference internal" href="pid-eaa-issuance.html#fig-low-level-flow-itwallet-pid-qeaa-issuance"><span class="std std-numref">Fig. 13</span></a>):</p>
<ul class="simple">
<li><p>Authorization (Steps 8-10): The Wallet Instance sends an authorization request, and the Issuer authenticates the User using a CieID scheme or a valid PID, providing the Access Token to the User.</p></li>
<li><p>Proof of Key Possession (Steps 12-13, 16-17): The Wallet creates a DPoP Proof JWT, binding the Access Token to the Wallet Instance. The same key is then used later to request the Credential, ensuring continuity of ownership.</p></li>
<li><p>Credential Issuance (Steps 18-21): The Credential request is verified using proof of possession, which is cryptographically bound to the User. The use of the same key in the DPoP ensures that the key material is controlled by the Wallet Instance, and not by a third party.</p></li>
</ul>
</section>
<section id="sr-i-50">
<h3>SR-I-50<a class="headerlink" href="#sr-i-50" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>(conditional w.r.t I-10) The Issuer must ensure that the Credential was stored in a secure Wallet.</p></td>
</tr>
</tbody>
</table>
<p>A trusted Wallet Attestation ensures that the Wallet Instance is secure and meets the required security standards before any Credentials are issued or stored.
In Steps 5-6 of <a class="reference internal" href="pid-eaa-issuance.html#fig-low-level-flow-itwallet-pid-qeaa-issuance"><span class="std std-numref">Fig. 13</span></a>, the Wallet Instance provides a Wallet Attestation, which includes a proof of possession
signed with the Wallet's private key. This attestation confirms that the Wallet Instance is genuine and has been verified by the Wallet Provider.</p>
<p>The Issuer verifies this attestation before allowing the Wallet to participate in the issuance process, ensuring that the Wallet adheres to specific security standards.
Afterward, all cryptographic keys generated and used in the process come from this attested Wallet Instance.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is currently an open issue on this aspect (<a class="reference external" href="https://github.com/openid/OpenID4VCI/issues/355">https://github.com/openid/OpenID4VCI/issues/355</a>) in the OpenID4VCI spec.</p>
</div>
</section>
<section id="sr-p-20">
<h3>SR-P-20<a class="headerlink" href="#sr-p-20" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The protocol must ensure that no third party can interfere with the issuance process such that the Issuer issues Credentials for the third party to the User.</p></td>
</tr>
</tbody>
</table>
<p>This requirement is addressed by secure identification of the Issuer. The &quot;iss&quot; parameter in the authorization response assures the Wallet that the response is coming from the expected Issuer and the cryptographic verification of the received tokens ensures that they were issued by the legitimate Issuer. In addition, the use of PKCE avoids injection of the code from another session to the User session.</p>
</section>
<section id="sr-p-30">
<h3>SR-P-30<a class="headerlink" href="#sr-p-30" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The protocol must ensure that the interaction between the Wallet and Verifier is protected such that no third party can interfere with the interaction by modifying the information transmitted.</p></td>
</tr>
</tbody>
</table>
<p>The presentation process occurs through different flows, including remote and proximity. In the case of the remote flow, a combination of signed Request Objects, <strong>nonce</strong> usage, Trust Chain validation, Wallet Attestation, and Holder binding ensures that no third party can interfere with or modify the information transmitted between the Wallet and the Verifier. These mechanisms align with Security Requirement P-30, protecting the interaction from tampering or injection attacks.</p>
</section>
<section id="sr-p-40">
<h3>SR-P-40<a class="headerlink" href="#sr-p-40" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_orange_checkmark.svg"><img alt="partially-check-icon" src="_images/Eo_circle_orange_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The protocol must ensure that the interaction between an attacker and a Verifier cannot be forwarded to and successfully completed by a User.</p></td>
</tr>
</tbody>
</table>
<p>In the case of the same device flow, this can be prevented by using and properly checking the <strong>nonce</strong> value, which is created and sent by the Verifier in the authorization request.
The Verifier should maintain a mapping between User sessions and the <strong>nonce</strong> that is expected in the flow. The Verifier should only accept a presentation if the <strong>nonce</strong> in the presentation
matches the <strong>nonce</strong> that is expected for the User session. With this countermeasure, the Verifier must detect if a presentation is sent that was not bound to the User's session or if no
User session exists at all, preventing the attack.</p>
<p>For cross-device flow the requirement is partially satisfied as the flow is vulnerable to Cross-Device Consent Phishing attacks (an attacker could initiate the presentation flow,
obtain the signed Request Object and QR code, and forward it to the victim).</p>
<p>Some security measures are already in place, such as the use of <strong>nonce</strong> and state. The <strong>nonce</strong> ensures freshness of the request, and the state binds the flow to a unique transaction,
thus reducing the opportunity for a successful attack.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Other security measures are currently under evaluation in issue number [117](<a class="reference external" href="https://github.com/italia/eid-wallet-it-docs/issues/117">https://github.com/italia/eid-wallet-it-docs/issues/117</a>),
where a list of mitigations from [<a class="reference external" href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-cross-device-security-08">OAuthCrossDeviceSec</a>] are discussed. Two examples are:</p>
<ul class="simple">
<li><p>Short Lived/Timebound QR Codes: Reducing the lifetime of the QR code (e.g., 2-3 mins) is necessary to restrict the time window available for the attacks.</p></li>
<li><p>One-Time QR Codes: One-Time QR codes restrict the possibility of attacks when the same QR code is sent to multiple victims.</p></li>
</ul>
</div>
</section>
<section id="sr-p-41">
<h3>SR-P-41<a class="headerlink" href="#sr-p-41" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The protocol must ensure that an attacker cannot successfully forward an interaction between a Wallet and a Verifier to a Verifier under the control of the attacker.</p></td>
</tr>
</tbody>
</table>
<p>A prerequisite for a successful attack of this kind is that the attacker has access to some messages between the Wallet and the Verifier, for example,
the attacker might have access to the presentation contained in the VP Token. Given that, the proper implementation of TLS guarrantes confidentiality, avoiding the leakage of the response.
In addition to TLS, the existing implementation of <strong>nonce</strong> and audience checks in the presentation protocol should help to meet the P-41 security requirement.
Regarding the <strong>nonce</strong> claim, the Verifier MUST check that the <strong>nonce</strong> value in the VP Token matches the <strong>nonce</strong> value that is created by the Verifier during the authorization request.
Regarding the <strong>aud</strong> value, the Verifier must check that the audience of the presentation matches the Verifier's identifier.</p>
</section>
<section id="sr-p-50">
<h3>SR-P-50<a class="headerlink" href="#sr-p-50" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_orange_checkmark.svg"><img alt="partially-check-icon" src="_images/Eo_circle_orange_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The protocol must ensure that third parties cannot interfere with the binding process.</p></td>
</tr>
</tbody>
</table>
<p>In the issuance phase, the Holder binding happens at the Credential request to the protected Credential endpoint. This means that the attacker needs to obtain the access token
first and therefore send the request to the Credential endpoint and bind the Credentials to the keys under his control. The IT-Wallet specification requires the use of a sender-constrained
access token, which means that the access token binds to the device using cryptographic materials.</p>
<p>The second surface for the attack is related to key management. In the case of using software-based keys, it is possible to clone the keys and move them to a device under
attacker control, and in the case of stealing the Credentials as well, the attacker can easily create proof of possession of the keys. IT-Wallet is less vulnerable to these attacks as it supports local
internal WSCD that uses hardware-based keys. However, the lack of a
certification profile that certifies the local internal WSCD against highly capable attackers (the certification for current TEE solutions on the market reaches AVA_VAN.3 at most
as shown for example in this <a class="reference external" href="https://www.tuv-nederland.nl/assets/files/cerfiticaten/2021/08/nscib-cc-0244671-cr-1.0.pdf">Certification Report</a> or <a class="reference external" href="https://globalplatform.org/specs-library/tee-protection-profile-v1-3/">Global Platform site</a> makes the requirement only partially satisfied.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the EUDI Wallet context, the local internal WSCD and other WSCD deployments are still under certification according to <a class="reference external" href="https://docbox.etsi.org/ESI/Open/workshops/202409_CEN_ETSI_Workshop/DAY3-8%20Certification%20for%20EU%20Digital%20Identity%20Wallets/DAY3-8-26%20ETSI_CEN_WS_WSCA%20Jan%20Kjaersgaard.pdf">CEN_ETSI_Workshop</a>.</p>
</div>
</section>
<section id="sr-v-10">
<h3>SR-V-10<a class="headerlink" href="#sr-v-10" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_orange_checkmark.svg"><img alt="partially-check-icon" src="_images/Eo_circle_orange_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>(conditional w.r.t  I-50+V-20) The Verifier must ensure that the Credential is stored in a secure Wallet.</p></td>
</tr>
</tbody>
</table>
<p>Verifier checks the Wallet Attestation during exchanges (sent with the authorization response), ensuring that it meets the security criteria required by the Verifier and is under the sole responsability of its issuer, the trusted Wallet Provider.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, no explicit security and privacy measures related to this requirement are specified in [<a class="reference external" href="https://openid.github.io/OpenID4VC_SecTrust/draft-oid4vc-security-and-trust.html">OpenID4VC-SecTrust</a>] and it is not clearly defined what &quot;stored in a secure Wallet&quot; means. Without this detail, this requirement is considered only partially satisfied. Indeed, the Wallet Attestation guarantees
that the Wallet Instance is operating on a secure, trusted device and adheres to the strict security policies set by the Wallet Provider. However, the attestation does not directly guarantee that each
Credential within the Wallet is stored securely; it verifies the overall security of the Wallet environment, within which the Credentials reside. Therefore, while the attestation supports the Verifier's
confidence that the Credential comes from a secure source, it is ultimately a broad assurance of the Wallet's security, rather than a specific validation of individual Credential storage.</p>
</div>
</section>
<section id="sr-v-20">
<h3>SR-V-20<a class="headerlink" href="#sr-v-20" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>(conditional w.r.t.  I-10) The Verifier must ensure that the Credential was issued by an Issuer that only issues Credentials to trustworthy Wallets.</p></td>
</tr>
</tbody>
</table>
<p>By checking the trust of the Issuer, the Verifier ensures that the Credential was issued by a trusted Issuer committed to issuing Credentials only to secure Wallets (as for SR-I-50).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, no explicit security and privacy measures related to this requirement are specified in [<a class="reference external" href="https://openid.github.io/OpenID4VC_SecTrust/draft-oid4vc-security-and-trust.html">OpenID4VC-SecTrust</a>], configuring this item as something that requires further developments and clarifications.</p>
</div>
</section>
<section id="sr-w-20">
<h3>SR-W-20<a class="headerlink" href="#sr-w-20" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Wallet must provide trustworthy and complete information about Issuers to the User.</p></td>
</tr>
</tbody>
</table>
<p>The Wallet Instance discovers the trusted Issuers using trusted third party resources, such as the Federation API (e.g., using the Subordinate Listing Endpoint of the Trust Anchor and its Intermediates), inspecting the Issuer metadata and Trust Marks for filtering the PID Provider.</p>
<p>The Issuer's information is displayed to the User during the issuance process and can be subsequently read by the User as it is inside the issued Credential.
In addition to the Issuer's information, the Digital Credential Metadata Type also contains information on the Authentic Source.</p>
</section>
<section id="sr-w-30">
<h3>SR-W-30<a class="headerlink" href="#sr-w-30" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Wallet must provide trustworthy and complete information about Verifiers to the User.</p></td>
</tr>
</tbody>
</table>
<p>The Wallet validates the Trust Chain related to the Verifier and its information is displayed to the User before the presentation.</p>
</section>
</section>
<section id="privacy-requirements">
<h2>Privacy Requirements<a class="headerlink" href="#privacy-requirements" title="Link to this heading">¶</a></h2>
<section id="pr-cf-30">
<h3>PR-CF-30<a class="headerlink" href="#pr-cf-30" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Credential Format must ensure that there is a robust mechanism to ensure that data that is not to be released to a Verifier cannot be extracted by the Verifier (selective disclosure).</p></td>
</tr>
</tbody>
</table>
<p>Both SD-JWT and mdoc-CBOR provide selective disclosure capability, allowing Holders to reveal only specific fields to the Verifier.</p>
</section>
<section id="pr-cf-40">
<h3>PR-CF-40<a class="headerlink" href="#pr-cf-40" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_orange_checkmark.svg"><img alt="partially-check-icon" src="_images/Eo_circle_orange_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Credential Format must support correlation protection.</p></td>
</tr>
</tbody>
</table>
<p>While selective disclosure is a strong tool for preventing correlation, full unlinkability is not guaranteed in all cases. Issues like Verifier collusion or Issuer tracking can arise.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Batch issuance, using different key binding keys and salts for each Credential, can mitigate Verifier/Verifier and presentation unlinkability risks.</p>
</div>
</section>
<section id="pr-e-60">
<h3>PR-E-60<a class="headerlink" href="#pr-e-60" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Trust Framework must ensure that the Issuer cannot learn where the User uses the Credential.</p></td>
</tr>
</tbody>
</table>
<p>The Verifier performing the Trust Evaluation about the Issuer of a Credential must not release any information to the Credential Issuer about the Wallet Instance it is interacting with. Using [<a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>] the Issuer doesn't know who is the User presenting the Credential.
In addition, privacy is protected also during the check of the Credential's status. By using Status Assertion [<a class="reference external" href="https://datatracker.ietf.org/doc/draft-demarco-oauth-status-assertions/03/">OAUTH-STATUS-ASSERTION</a>], the IT-Wallet specification ensures
that while the Verifier checks the Credential's validity, the Issuer does not learn where or when the Credential is being used.</p>
</section>
<section id="pr-e-70">
<h3>PR-E-70<a class="headerlink" href="#pr-e-70" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_orange_checkmark.svg"><img alt="partially-check-icon" src="_images/Eo_circle_orange_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Trust Framework must support correlation protection.</p></td>
</tr>
</tbody>
</table>
<p>The following mechanisms may be implemented to reduce the correlation:</p>
<ul class="simple">
<li><p><em>Verifier-Verifier</em>: evaluation mechanisms to ensure that a Verifier requests only the information it is authorized to obtain from the Wallet. This approach minimizes data exchange and helps prevent User profiling through potential collusion between Verifiers.</p></li>
<li><p><em>Issuer-Verifier</em>: The Issuer does not require the authentication of the Verifier during the trust evaluation. In principle, the Issuer does not know which Verifiers the User is accessing and will avoid User activity profiling based on the Verifier's access.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>OpenID Federation Trust Marks allow the definition of custom policies suitable to the satisfaction of this requirement.</p>
</div>
</section>
<section id="pr-w-40">
<h3>PR-W-40<a class="headerlink" href="#pr-w-40" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Wallet must ask the User for meaningful consent before a Credential is used. The Wallet must provide the User the opportunity to review any data that is released to a Verifier.</p></td>
</tr>
</tbody>
</table>
<p>After establishing trust with the Verifier, the Wallet asks for the User's consent and provides the User the opportunity to review and select the data to be presented to the Verifier.</p>
</section>
<section id="pr-w-60">
<h3>PR-W-60<a class="headerlink" href="#pr-w-60" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Wallet must ensure that the Issuer cannot learn where the User uses the Credential.</p></td>
</tr>
</tbody>
</table>
<p>Same as for SR-P-80.</p>
</section>
<section id="pr-w-70">
<h3>PR-W-70<a class="headerlink" href="#pr-w-70" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_red_letter-x.svg"><img alt="uncheck-icon" src="_images/Eo_circle_red_letter-x.svg" style="width: 25px;" /></a></p></td>
<td><p>The Wallet must ensure that the Verifier cannot learn that the same User is using other Verifiers.</p></td>
</tr>
</tbody>
</table>
<p>To mitigate Verifier/Verifier linkability for SD-JWT Credentials, one proposed solution is batch issuance, which involves using different cryptographic keys used in the key binding and salts for each issued Credential. However, the effectiveness of these methods has not yet been thoroughly evaluated, even in consideration of the impacts that these might result with the user experience, and is not available for IT-Wallet yet.</p>
</section>
</section>
<section id="security-and-privacy-requirements">
<h2>Security and Privacy Requirements<a class="headerlink" href="#security-and-privacy-requirements" title="Link to this heading">¶</a></h2>
<section id="spr-e-50">
<h3>SPR-E-50<a class="headerlink" href="#spr-e-50" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Trust Framework must ensure that lifecycles of keys, certificates, and Credentials are designed such that the impact of a compromise is minimized.</p></td>
</tr>
</tbody>
</table>
<p>The Credential lifecycle includes a Credential revocation mechanism based on Status Assertion [<a class="reference external" href="https://datatracker.ietf.org/doc/draft-demarco-oauth-status-assertions/03/">OAUTH-STATUS-ASSERTION</a>] that ensures that Credentials are properly revoked when compromised or outdated.</p>
<p>The revocation of a Federation Entity (i.e., Issuer, Verifier, Wallet Provider) is instead possible by not issuing the corresponding Subordinate Statement about that Entity and set a short expiration of the Trust Chain, thus preventing misuse during compromise.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In addition, [<a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>] supports a historical key endpoint to retrieve the list of expired and revoked keys, with the motivation of the revocation.</p>
</div>
</section>
<section id="spr-p-10">
<h3>SPR-P-10<a class="headerlink" href="#spr-p-10" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The protocol must ensure that no third party can read the Credential issued by the Issuer.</p></td>
</tr>
</tbody>
</table>
<p>To mitigate this threat, the IT-Wallet specification requires the following security mechanisms in the issuance process:</p>
<ul class="simple">
<li><p><em>TLS</em>: Used in all communication between the Wallet and the Issuer, ensuring that data in transit is encrypted and protected from interception by attackers.</p></li>
<li><p><em>Wallet Attestation</em>: Ensures that the Wallet operates on a secure, trusted device and complies with the security standards required by the Issuer, providing additional assurance that the Issuer is interacting with a legitimate Wallet Instance.</p></li>
<li><p><em>DPoP</em>: Ensures that the Holder of the access token possesses the private key associated with it, preventing attackers from reusing intercepted tokens.</p></li>
<li><p><em>Holder binding</em>: Ties the Credential to a specific Holder, ensuring that only the legitimate Holder can use a Credential to authenticate with the Issuer.</p></li>
<li><p><em>redirect_uri validation</em>: This validation ensures that the authorization response is sent to the correct and authorized endpoint, thereby preventing unauthorized interception by malicious actors. Ensuring the integrity of the <strong>redirect_uri</strong> is critical to avoid any manipulation or misdirection of the URI.</p></li>
<li><p><em>PKCE</em>:  Avoids injection of a legit authorization <strong>code</strong> in another session.</p></li>
</ul>
</section>
<section id="spr-p-60">
<h3>SPR-P-60<a class="headerlink" href="#spr-p-60" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The protocol must ensure that during an interaction with a Verifier, an attacker cannot read PII.</p></td>
</tr>
</tbody>
</table>
<p>The IT Wallet complies with the requirements of P-60 by ensuring that all network connections are secured by TLS.</p>
<p>In addition, as the Authorization Response contains PII is important that it is not sent to an attacker-controlled endpoint.
In the IT Wallet specification the <strong>response_uri</strong>, which is the endpoint where the Wallet sends the Authorization Response, is included in the signed Request Object,
which is verified by the Wallet using the Verifier's public key and Trust Chain. This guarantees that the Authorization Response is being sent to the correct endpoint.
Additionally, the Authorization Response is encrypted with the Verifier's public key, ensuring that only the intended recipient can decrypt and read the sensitive information,
further securing the transmission.</p>
<p>Another endpoint to be validated is the <strong>redirect_uri</strong>, which is used to redirect the User back to the Verifier after the Credential presentation is complete.
In the IT-Wallet specification, the <strong>redirect_uri</strong> is registered and validated beforehand during the Verifier onboarding using OpenID Federation. During the presentation phase, the Wallet must validate this value by verifying the trust with the Verifier according to the Section <a class="reference external" href="trust.html#trust-evaluation-mechanism">Trust Evaluation Mechanism</a></p>
<p>In order to be sure that the <strong>redirect_uri</strong> is received from a legit Wallet and not from the attacker, the Verifier response endpoint upon the recipient of a valid
authorization response creates a fresh cryptographic value that is linked to the authorization response and attaches it to the <strong>redirect_uri</strong> that is sent to the Wallet.
When the Verifier receives the redirect, it can extract the response code and check with its response endpoint whether the response code was associated with this Authorization
Response. (See <a class="reference internal" href="remote-flow.html#redirect-uri"><span class="std std-ref">Redirect URI Section</span></a>).</p>
</section>
<section id="spr-p-70">
<h3>SPR-P-70<a class="headerlink" href="#spr-p-70" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The protocol must ensure that during an interaction with an Issuer, an attacker cannot read PII.</p></td>
</tr>
</tbody>
</table>
<p>In the issuance process, as the Credential inside a Credential Response contains PII, it is required that the Credential is not sent to or intercepted by an attacker.
To mitigate these threats, the IT-Wallet specification requires the following security mechanisms:</p>
<ul class="simple">
<li><p><em>TLS</em>: Used in all communication between the Wallet and the Issuer, ensuring that data in transit is encrypted and protected from interception by attackers.</p></li>
<li><p><em>Wallet Instance Attestation</em>: Ensures that the Wallet operates on a secure, trusted device and complies with the security standards required by the Issuer, providing additional assurance that the Issuer is interacting with a legitimate Wallet Instance.</p></li>
<li><p><em>DPoP</em>: Ensures that the Holder of the access token possesses the private key associated with it, preventing attackers from reusing intercepted tokens.</p></li>
<li><p><em>Holder binding</em>: Ties the Credential to a specific Holder, ensuring that only the legitimate Holder can use a Credential to authenticate with the Issuer.</p></li>
<li><p><em>redirect_uri validation</em>: This validation ensures that the authorization response is sent to the correct and authorized endpoint, thereby preventing unauthorized interception by malicious actors. Ensuring the integrity of the <strong>redirect_uri</strong> is critical to avoid any manipulation or misdirection of the URI.</p></li>
<li><p><em>PKCE</em>:  Avoids injection of a legit authorization <strong>code</strong> in another session.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A further security enhancement that could be applied to add an extra layer of protection for sensitive User information is the encryption of Credential responses.
OpenID4VCI standard provides the option for the Wallet to request encrypted Credentials containing PII by including a <strong>credential_response_encryption</strong> object in its request.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, no explicit security and privacy measures related to this requirement are specified in [<a class="reference external" href="https://openid.github.io/OpenID4VC_SecTrust/draft-oid4vc-security-and-trust.html">OpenID4VC-SecTrust</a>], it remains a work in progress.</p>
</div>
</section>
<section id="spr-p-80">
<h3>SPR-P-80<a class="headerlink" href="#spr-p-80" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The protocol must ensure that the Issuer cannot learn where the User uses the Credential.</p></td>
</tr>
</tbody>
</table>
<p>The exchange protocol does not require any interactions between Verifiers and Issuers. In addition, privacy-preserving Status Assertions, presented along with Credentials,
ensure that while the Verifier checks the Credential's validity, the Issuer does not learn where or when the Credential is being used.</p>
</section>
<section id="spr-w-50">
<h3>SPR-W-50<a class="headerlink" href="#spr-w-50" title="Link to this heading">¶</a></h3>
<table class="docutils align-default">
<colgroup>
<col style="width: 8.0%" />
<col style="width: 92.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="_images/Eo_circle_green_checkmark.svg"><img alt="check-icon" src="_images/Eo_circle_green_checkmark.svg" style="width: 25px;" /></a></p></td>
<td><p>The Wallet must ensure that the Credentials and private keys are protected from unauthorized access.</p></td>
</tr>
</tbody>
</table>
<p>To prevent unauthorized access to the Wallet, it is unlocked on the User's device by entering a personal identification number (PIN) or using biometric authentication, such as fingerprint or facial recognition, based on the User's preferences and the device's capabilities. Additionally, the cryptographic keys are securely stored within the WSCD, ensuring that only the User can access them, thereby preventing unauthorized use or tampering.</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&lt;</span><span>Page contents</span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&gt;</span><span>Page contents:</span></a></p>
            <div class="page_toc">
                <ul>
<li><a class="reference internal" href="#">Security and Privacy Considerations</a><ul>
<li><a class="reference internal" href="#security-requirements">Security Requirements</a><ul>
<li><a class="reference internal" href="#sr-cf-10-and-sr-e-10">SR-CF-10 and SR-E-10</a></li>
<li><a class="reference internal" href="#sr-cf-20">SR-CF-20</a></li>
<li><a class="reference internal" href="#sr-cf-21">SR-CF-21</a></li>
<li><a class="reference internal" href="#sr-e-20">SR-E-20</a></li>
<li><a class="reference internal" href="#sr-e-30">SR-E-30</a></li>
<li><a class="reference internal" href="#sr-e-40">SR-E-40</a></li>
<li><a class="reference internal" href="#sr-i-10">SR-I-10</a></li>
<li><a class="reference internal" href="#sr-i-20">SR-I-20</a></li>
<li><a class="reference internal" href="#sr-i-30">SR-I-30</a></li>
<li><a class="reference internal" href="#sr-i-40">SR-I-40</a></li>
<li><a class="reference internal" href="#sr-i-50">SR-I-50</a></li>
<li><a class="reference internal" href="#sr-p-20">SR-P-20</a></li>
<li><a class="reference internal" href="#sr-p-30">SR-P-30</a></li>
<li><a class="reference internal" href="#sr-p-40">SR-P-40</a></li>
<li><a class="reference internal" href="#sr-p-41">SR-P-41</a></li>
<li><a class="reference internal" href="#sr-p-50">SR-P-50</a></li>
<li><a class="reference internal" href="#sr-v-10">SR-V-10</a></li>
<li><a class="reference internal" href="#sr-v-20">SR-V-20</a></li>
<li><a class="reference internal" href="#sr-w-20">SR-W-20</a></li>
<li><a class="reference internal" href="#sr-w-30">SR-W-30</a></li>
</ul>
</li>
<li><a class="reference internal" href="#privacy-requirements">Privacy Requirements</a><ul>
<li><a class="reference internal" href="#pr-cf-30">PR-CF-30</a></li>
<li><a class="reference internal" href="#pr-cf-40">PR-CF-40</a></li>
<li><a class="reference internal" href="#pr-e-60">PR-E-60</a></li>
<li><a class="reference internal" href="#pr-e-70">PR-E-70</a></li>
<li><a class="reference internal" href="#pr-w-40">PR-W-40</a></li>
<li><a class="reference internal" href="#pr-w-60">PR-W-60</a></li>
<li><a class="reference internal" href="#pr-w-70">PR-W-70</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-and-privacy-requirements">Security and Privacy Requirements</a><ul>
<li><a class="reference internal" href="#spr-e-50">SPR-E-50</a></li>
<li><a class="reference internal" href="#spr-p-10">SPR-P-10</a></li>
<li><a class="reference internal" href="#spr-p-60">SPR-P-60</a></li>
<li><a class="reference internal" href="#spr-p-70">SPR-P-70</a></li>
<li><a class="reference internal" href="#spr-p-80">SPR-P-80</a></li>
<li><a class="reference internal" href="#spr-w-50">SPR-W-50</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
        </div>
    

      <div class="clearer"></div>
    </div>
    <div class="button_nav_wrapper">
        <div class="button_nav">
            <div class="left">
                
                <a href="algorithms.html">
                    <span class="icon">&lt;</span><span>Cryptographic Algorithms</span></a>
                
            </div>

            <div class="right">
                
                    <a href="log-retention-policy.html"><span>General Log Retention Policies</span><span class="icon">&gt;</span></a>
                
            </div>
        </div>
    </div>


    <div class="footer" role="contentinfo">
      Last updated on 28/04/2025.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.5.
    </div>

<p id="theme_credit"></p>
  </body>
</html>