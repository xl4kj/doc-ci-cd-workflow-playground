<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="402px" preserveAspectRatio="none" style="width:829px;height:402px;background:#FFFFFF;" version="1.1" viewBox="0 0 829 402" width="829px" zoomAndPan="magnify"><title>Voucher Issuance - e-Service</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="228.0742" x="297.5447" y="27.9951">Voucher Issuance - e-Service</text><rect fill="#FFFFF0" height="353.6563" style="stroke:#181818;stroke-width:0.5;" width="122.2627" x="16" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="73.4932" x="38.1218" y="55.3638">Consumer</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4.5259" x="111.615" y="55.3638"> </text><rect fill="#F0FFFF" height="353.6563" style="stroke:#181818;stroke-width:0.5;" width="240.5723" x="582.5913" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.9897" x="679.6196" y="55.3638">PDND</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4.5259" x="721.6094" y="55.3638"> </text><rect fill="none" height="101.3984" style="stroke:#000000;stroke-width:1.5;" width="558.6772" x="10" y="110.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="77" x2="77" y1="93.7266" y2="362.6563"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="702.5913" x2="702.5913" y1="93.7266" y2="362.6563"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114.2627" x="20" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="100.2627" x="27" y="82.4248">OAuth Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114.2627" x="20" y="361.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="100.2627" x="27" y="381.6514">OAuth Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="232.5723" x="586.5913" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="218.5723" x="593.5913" y="82.4248">OAuth Authorization Server</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="232.5723" x="586.5913" y="361.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="218.5723" x="593.5913" y="381.6514">OAuth Authorization Server</text><path d="M10,110.7266 L79.4512,110.7266 L79.4512,117.8594 L69.4512,127.8594 L10,127.8594 L10,110.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="101.3984" style="stroke:#000000;stroke-width:1.5;" width="558.6772" x="10" y="110.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.4512" x="25" y="123.7935">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="130.2705" x="94.4512" y="122.937">[For AUDIT_REST_02]</text><line style="stroke:#181818;stroke-width:1;" x1="77.1313" x2="119.1313" y1="148.9922" y2="148.9922"/><line style="stroke:#181818;stroke-width:1;" x1="119.1313" x2="119.1313" y1="148.9922" y2="161.9922"/><line style="stroke:#181818;stroke-width:1;" x1="78.1313" x2="119.1313" y1="161.9922" y2="161.9922"/><polygon fill="#181818" points="88.1313,157.9922,78.1313,161.9922,88.1313,165.9922,84.1313,161.9922" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="84.1313" y="143.9263">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260.5967" x="97.1768" y="143.9263">Prepare JWT with complementary data (</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="125.2266" x="357.7734" y="143.9263">TrackingEvidence</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="483" y="143.9263">)</text><line style="stroke:#181818;stroke-width:1;" x1="77.1313" x2="119.1313" y1="191.125" y2="191.125"/><line style="stroke:#181818;stroke-width:1;" x1="119.1313" x2="119.1313" y1="191.125" y2="204.125"/><line style="stroke:#181818;stroke-width:1;" x1="78.1313" x2="119.1313" y1="204.125" y2="204.125"/><polygon fill="#181818" points="88.1313,200.125,78.1313,204.125,88.1313,208.125,84.1313,204.125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="84.1313" y="186.0591">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.1592" x="97.1768" y="186.0591">Compute SHA256 hash of</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="125.2266" x="268.4683" y="186.0591">TrackingEvidence</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="397.8271" y="186.0591">(</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="148.7065" x="402.8989" y="186.0591">H(TrackingEvidence)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="551.6055" y="186.0591">)</text><line style="stroke:#181818;stroke-width:1;" x1="77.1313" x2="119.1313" y1="240.2578" y2="240.2578"/><line style="stroke:#181818;stroke-width:1;" x1="119.1313" x2="119.1313" y1="240.2578" y2="253.2578"/><line style="stroke:#181818;stroke-width:1;" x1="78.1313" x2="119.1313" y1="253.2578" y2="253.2578"/><polygon fill="#181818" points="88.1313,249.2578,78.1313,253.2578,88.1313,257.2578,84.1313,253.2578" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="84.1313" y="235.1919">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.7183" x="97.1768" y="235.1919">Create DPoP key pair and proof</text><polygon fill="#181818" points="690.8774,278.3906,700.8774,282.3906,690.8774,286.3906,694.8774,282.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="77.1313" x2="696.8774" y1="282.3906" y2="282.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="84.1313" y="277.3247">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.542" x="97.1768" y="277.3247">Voucher Request (</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="70.4399" x="217.7188" y="277.3247">client_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="288.1587" y="277.3247">,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="125.2266" x="296.4233" y="277.3247">client_assertion</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="421.6499" y="277.3247">,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="164.3599" x="429.9146" y="277.3247">client_assertion_type</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="594.2744" y="277.3247">,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="78.2666" x="602.5391" y="277.3247">grant_type</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="680.8057" y="277.3247">)</text><rect fill="#FFB6C1" height="23" style="stroke:#181818;stroke-width:0.5;" width="54" x="675" y="295.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46.7632" x="679" y="311.4575">Checks</text><polygon fill="#181818" points="88.1313,340.6563,78.1313,344.6563,88.1313,348.6563,84.1313,344.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="82.1313" x2="701.8774" y1="344.6563" y2="344.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="94.1313" y="339.5903">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.1714" x="107.1768" y="339.5903">Voucher Response (</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="93.9199" x="237.3481" y="339.5903">access_token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="331.2681" y="339.5903">,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="78.2666" x="339.5327" y="339.5903">token_type</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="417.7993" y="339.5903">,</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="78.2666" x="426.064" y="339.5903">expires_in</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="504.3306" y="339.5903">)</text><!--SRC=[TP9DImCn48Rl-HN3Uh6B1H7qu45OjXOheejRzRZ4TEo6RJFh9AdMN-za_QY8Na8-dppp9i665S8zHTCYmypxg9r160EEQ-IDDQYKZe5SN3yYA_L8hv3d9JaVryXv3dkp3V5M0VIQWpMsrov0bkStHGmjb2kBBkHv1jf3ELNe5Y28BqurkPuaHl4M6VzZf8ROlkbWoK6oIXSFnABU4QaFC2M6ucuocpUtv_MyEJmIPZaTdvNJqufHw0YN3tDuiO8rjEvNk1OzpLjOwA1XFylch4rdtV9yOnSeIMJPIEqWfPo90Q6-A8wEJw3LlWLwWh-E9TZ5_k_vKUA9ib9VH4Ojm4b55NIubGGiWvQQUYPw6dOLzUdt0ztYSqGV4jmCqJPsaMK7y3tKtYEdeFwURSAsnu-b9KlAdsEfaHs91qcsaYhiNTbb6ohhkbHyYwRpINlOf5HHZmVvdPNlvKTWqjB6eFTDe0u_7ORkZulnjRUClh6oFde7]--></g></svg>