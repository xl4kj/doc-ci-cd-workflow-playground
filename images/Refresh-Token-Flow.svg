<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="285px" preserveAspectRatio="none" style="width:699px;height:285px;background:#FFFFFF;" version="1.1" viewBox="0 0 699 285" width="699px" zoomAndPan="magnify"><defs/><g><g><title>Wallet Instance</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="214.0625" width="8" x="67.1509" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="71" x2="71" y1="36.2969" y2="250.3594"/></g><g><title>Credential Issuer</title><rect fill="#FFFFFF" fill-opacity="0.00000" height="214.0625" width="8" x="611.5518" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="615.2236" x2="615.2236" y1="36.2969" y2="250.3594"/></g><g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.3018" x="10" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.3018" x="17" y="24.9951">Wallet Instance</text></g><g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.3018" x="10" y="249.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.3018" x="17" y="269.3545">Wallet Instance</text></g><g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="154.6563" x="538.2236" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140.6563" x="545.2236" y="24.9951">Credential Issuer</text></g><g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="154.6563" x="538.2236" y="249.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140.6563" x="545.2236" y="269.3545">Credential Issuer</text></g><g><line style="stroke:#181818;stroke-width:1;" x1="71.1509" x2="113.1509" y1="67.4297" y2="67.4297"/><line style="stroke:#181818;stroke-width:1;" x1="113.1509" x2="113.1509" y1="67.4297" y2="80.4297"/><line style="stroke:#181818;stroke-width:1;" x1="72.1509" x2="113.1509" y1="80.4297" y2="80.4297"/><polygon fill="#181818" points="82.1509,76.4297,72.1509,80.4297,82.1509,84.4297,78.1509,80.4297" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="78.1509" y="62.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="477.147" x="91.1963" y="62.3638">generate DPoP proof and WA-PoP for Credential Issuer token endpoint</text></g><g><polygon fill="#181818" points="603.5518,150.9609,613.5518,154.9609,603.5518,158.9609,607.5518,154.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="71.1509" x2="609.5518" y1="154.9609" y2="154.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="78.1509" y="127.1958">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.0874" x="91.1963" y="104.4966">Token Request with DPoP proof (</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.5723" x="99.4609" y="119.6294">grant_type,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.6626" x="99.4609" y="134.7622">refresh_token)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="503.2231" x="95.3286" y="149.895">with OAuth-Client-Attestation and OAuth-Client-Attestation-PoP in the header</text></g><g><polygon fill="#181818" points="82.1509,180.0938,72.1509,184.0938,82.1509,188.0938,78.1509,184.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="76.1509" x2="614.5518" y1="184.0938" y2="184.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="88.1509" y="179.0278">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="460.9731" x="101.1963" y="179.0278">Token Response (access_token, refresh_token, token_type, expires_in)</text></g><polygon fill="#FFFFFF" points="15,197.0938,672,197.0938,682,216.0938,672,235.0938,15,235.0938,5,216.0938,15,197.0938" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="531.6162" x="78.1318" y="213.1606">The flow continues with a request to the deferred/notification/credential endpoint</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.7104" x="82.2642" y="228.2935">with the new DPoP access token</text><!--SRC=[TP31JiCm38RlVGfhN3PfrUuSa2esYPueQD8kI5D8tTMYs25nARmzQS8Ga-0OE_do_RyPLNXyVKPV5Cvu9KlEiCBYO8O15MeEQjZY0ao0wV9AKsytouVLhggWyV9EBVfqZOfYWl869hY64p9wemZRHXfmNgG3moqSgd8UTEBX3moel203Skk4MBzv57dxj7Z4jn63maJQ_oOldnZWvAFTKJyThkUZnyvZw8y9kO8uIg_kgr7xydOWP2qhrOWpIiB9xhzbSYO6xH5wDEtS6fsZdjM24mu8IsCjXf3_NLzgh7F0B0duuIZkZiIhekXPObl6UWa1hWvtzNuNqV6_Rf09hB0In-mvX8dOt8HAacgnG- -ntKGATMIJzSR6IKn2PlYfz5p3_8XnoYLcu-ps1G00]--></g></svg>