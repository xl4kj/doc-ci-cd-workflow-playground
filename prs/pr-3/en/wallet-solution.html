<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Wallet Solution &#8212; IT-Wallet Technical Specification c  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/basic_mod.css?v=9b2032db" />
    <link rel="stylesheet" type="text/css" href="_static/itwallet-override.css?v=63798874" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <script src="_static/js/petite-vue.js"></script>
    <link rel="icon" href="https://avatars.githubusercontent.com/u/15377824?s=48&amp;v=4"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Issuer Solution" href="issuer-solution.html" />
    <link rel="prev" title="The Infrastructure of Trust" href="trust.html" /> 
  </head><body data-dark_mode_code_blocks="true">

<div id="top_nav">
    

    <nav>
        
            
        

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="index.html" title="Go to homepage">IT-Wallet Technical Specification c  documentation</a></h1>
            <a id="source_link" href="https://github.com/italia/eudi-wallet-it-docs">
    
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
            <path fill="white" d="M 244.8,8 C 106.1,8 0,113.3 0,252 c 0,110.9 69.8,205.8 169.5,239.2 12.8,2.3 17.3,-5.6 17.3,-12.1 0,-6.2 -0.3,-40.4 -0.3,-61.4 0,0 -70,15 -84.7,-29.8 0,0 -11.4,-29.1 -27.8,-36.6 0,0 -22.9,-15.7 1.6,-15.4 0,0 24.9,2 38.6,25.8 21.9,38.6 58.6,27.5 72.9,20.9 2.3,-16 8.8,-27.1 16,-33.7 -55.9,-6.2 -112.3,-14.3 -112.3,-110.5 0,-27.5 7.6,-41.3 23.6,-58.9 -2.6,-6.5 -11.1,-33.3 2.6,-67.9 20.9,-6.5 69,27 69,27 20,-5.6 41.5,-8.5 62.8,-8.5 21.3,0 42.8,2.9 62.8,8.5 0,0 48.1,-33.6 69,-27 13.7,34.7 5.2,61.4 2.6,67.9 16,17.7 25.8,31.5 25.8,58.9 0,96.5 -58.9,104.2 -114.8,110.5 9.2,7.9 17,22.9 17,46.4 0,33.7 -0.3,75.4 -0.3,83.6 0,6.5 4.6,14.4 17.3,12.1 C 428.2,457.8 496,362.9 496,252 496,113.3 383.5,8 244.8,8 Z"/>
        </svg>
    
</a>
        

        <a id="mode_toggle" href="#" @click.prevent="handleClick" :title="mode">
    <template v-if="mode == 'light'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_light"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M67.48,18.073c1.913,-1.912 1.913,-5.018 0,-6.931c-1.912,-1.912 -5.018,-1.912 -6.931,0l-6.798,6.799c-1.912,1.912 -1.912,5.018 0,6.931c1.913,1.912 5.018,1.912 6.931,-0l6.798,-6.799Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.728,61.108c1.912,-1.913 1.912,-5.018 -0,-6.931c-1.913,-1.913 -5.019,-1.913 -6.931,-0l-6.799,6.798c-1.912,1.913 -1.912,5.019 0,6.931c1.913,1.913 5.019,1.913 6.931,0l6.799,-6.798Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.682,54.177c-1.913,-1.913 -5.018,-1.913 -6.931,-0c-1.912,1.913 -1.912,5.018 0,6.931l6.798,6.798c1.913,1.913 5.019,1.913 6.931,0c1.913,-1.912 1.913,-5.018 0,-6.931l-6.798,-6.798Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M4.901,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,-0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M18.929,11.142c-1.912,-1.912 -5.018,-1.912 -6.931,0c-1.912,1.913 -1.912,5.019 0,6.931l6.799,6.799c1.912,1.912 5.018,1.912 6.931,-0c1.912,-1.913 1.912,-5.019 -0,-6.931l-6.799,-6.799Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.108,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c-0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c-0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'dark'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_dark"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.901,2.196 -4.901,4.901c0,2.705 2.197,4.901 4.901,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.662,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.989,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.732,61.103c1.91,-1.91 1.91,-5.011 0,-6.921l-0.009,-0.01c-1.91,-1.91 -5.012,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.909,1.91 5.011,1.91 6.92,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.672,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.52,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l-0,-0.01c-0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.901,2.196 -4.901,4.901c0,2.704 2.197,4.9 4.901,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.73,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 -0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.098,34.623c-2.699,0 -4.891,2.192 -4.891,4.892l-0,0.019c-0,2.699 2.192,4.891 4.891,4.891c2.7,0 4.892,-2.192 4.892,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.892,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'darkest'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_darkest"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><path d="M39.315,23.791c8.684,-0 15.734,7.05 15.734,15.733c0,8.684 -7.05,15.734 -15.734,15.734c-8.683,0 -15.733,-7.05 -15.733,-15.734c-0,-8.683 7.05,-15.733 15.733,-15.733Zm0,4.737c6.069,0 10.997,4.927 10.997,10.996c-0,6.069 -4.928,10.996 -10.997,10.996c-6.068,0 -10.996,-4.927 -10.996,-10.996c0,-6.069 4.928,-10.996 10.996,-10.996Z" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.216,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.9,2.196 -4.9,4.901c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.666,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.99,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.737,61.103c1.909,-1.91 1.909,-5.011 -0,-6.921l-0.01,-0.01c-1.91,-1.91 -5.011,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.91,1.91 5.011,1.91 6.921,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.676,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.524,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l0,-0.01c0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.216,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901c-0,2.704 2.196,4.9 4.9,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.734,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.103,34.623c-2.7,0 -4.892,2.192 -4.892,4.892l-0,0.019c-0,2.699 2.192,4.891 4.892,4.891c2.699,0 4.891,-2.192 4.891,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.891,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>
</a>

<script>
(function() {
    const LOCAL_STORAGE_KEY = 'piccoloThemeMode'

    var initialMode = localStorage.getItem(LOCAL_STORAGE_KEY)

    if (initialMode) {
        // Make sure the value in local storage is valid
        if (['light', 'dark', 'darkest'].indexOf(initialMode) == -1) {
            initialMode = 'light'
            localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
        }
    } else {
        // Check if the client prefers dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            initialMode = 'dark'
        } else {
            initialMode = 'light'
        }
        localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
    }

    document.documentElement.dataset.mode = initialMode

    PetiteVue.createApp({
        'mode': initialMode,
        handleClick() {
            let currentMode = this.mode

            if (currentMode == 'light') {
                this.mode = 'dark'
            } else if (currentMode == 'dark') {
                this.mode = 'darkest'
            } else if (currentMode == 'darkest') {
                this.mode = 'light'
            }

            document.documentElement.dataset.mode = this.mode
            localStorage.setItem(LOCAL_STORAGE_KEY, this.mode)

            console.log(this.mode)
        }
    }).mount('#mode_toggle')
})()
</script>
            <p class="mobile_search_link">
                <a href="search.html" title="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 64" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2">
                        <path d="M14.873 40.009c-2.315-3.943-3.642-8.532-3.642-13.429C11.231 11.91 23.141 0 37.811 0s26.58 11.91 26.58 26.58-11.91 26.58-26.58 26.58a26.44 26.44 0 0 1-14.277-4.161L9.739 62.794a3.12 3.12 0 0 1-4.413 0L.913 58.382c-1.217-1.218-1.217-3.196 0-4.413l13.96-13.96zM37.811 8.054c10.225 0 18.526 8.301 18.526 18.526s-8.301 18.526-18.526 18.526-18.526-8.301-18.526-18.526S27.586 8.054 37.811 8.054z" fill="#fff" />
                    </svg>
                </a>
            </p>
        

        <div class="searchbox_wrapper">
            
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
    </nav>
</div>

    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="defined-terms.html">Normative References</a></li>
<li class="toctree-l1"><a class="reference internal" href="defined-terms.html#defined-terms-and-acronyms">Defined Terms and Acronyms</a></li>
<li class="toctree-l1"><a class="reference internal" href="defined-terms.html#normative-language-and-conventions">Normative Language and Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="ssi-introduction.html">The Digital Identity Wallet Paradigm</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html#it-wallet-system-brand-identity">IT-Wallet System Brand Identity</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html#functionalities">Functionalities</a></li>
<li class="toctree-l1"><a class="reference internal" href="trust.html">The Infrastructure of Trust</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Wallet Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="issuer-solution.html">Issuer Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="relying-party-solution.html">Relying Party Solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="pid-eaa-data-model.html">PID/(Q)EAA Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="registry-catalogue.html">Digital Credentials Catalogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="pid-eaa-issuance.html">PID/(Q)EAA Issuance</a></li>
<li class="toctree-l1"><a class="reference internal" href="pid-eaa-presentation.html">PID/(Q)EAA Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="credential-revocation.html">Digital Credential Lifecycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="authentic-sources.html">Authentic Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="backup-restore.html">Backup and Restore</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Cryptographic Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="security-privacy-considerations.html">Security and Privacy Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="log-retention-policy.html">General Log Retention Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="standards.html">Technical References</a></li>
<li class="toctree-l1"><a class="reference internal" href="test-plans.html">Test Plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="open-source.html">Open Source Releases for IT-Wallet Solutions</a></li>
</ul>

        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="wallet-solution">
<span id="wallet-solution-rst"></span><h1>Wallet Solution<a class="headerlink" href="#wallet-solution" title="Link to this heading">¶</a></h1>
<p>The Wallet Solution is issued by the Wallet Provider in the form of a mobile app and services, such as web interfaces. The mobile app serves as the primary interface for Users, allowing them to hold their Digital Credentials and interact with other participants of the ecosystem, such as Credential Issuers and Relying Parties. These Credentials are a set of data that can uniquely identify a natural or legal person, along with other Qualified and non-qualified Electronic Attestations of Attributes, also known as QEAAs and EAAs respectively, or (Q)EAAs for short. Once a User installs the mobile app on their device, such an installation is referred to as a Wallet Instance for the User. By supporting the mobile app, the Wallet Provider ensures the security and reliability of the entire Wallet Solution, as it is responsible for issuing the Wallet Attestation, which is a cryptographic proof about the authenticity and integrity of the Wallet Instance.</p>
<section id="wallet-solution-requirements">
<h2>Wallet Solution Requirements<a class="headerlink" href="#wallet-solution-requirements" title="Link to this heading">¶</a></h2>
<p>This section lists the requirements that Wallet Providers, Wallet Solutions, and their Wallet Instances must meet.</p>
<ul class="simple">
<li><p>The Wallet Solution MUST adhere to the specifications set by this document for obtaining Personal Identification (PID) and (Q)EAAs.</p></li>
<li><p>The Wallet Provider MUST expose a set of endpoints, exclusively available to its Wallet Solution instances, supporting the core functionalities of the Wallet Instances.</p></li>
<li><p>The Wallet Instance MUST periodically reestablish trust with its Wallet Provider, obtaining a fresh Wallet Attestation.</p></li>
<li><p>The Wallet Instance MUST establish trust with other participants of the Wallet ecosystem, such as Credential Issers and Relying Parties, presenting a Wallet Attestation.</p></li>
<li><p>The Wallet Instance MUST be compatible and functional on both Android and iOS operating systems and available on the Play Store and App Store, respectively.</p></li>
<li><p>The Wallet Instance MUST provide a mechanism to verify the User's actual possession and full control of their personal device.</p></li>
<li><p>The Wallet Instance MUST provide Users with an up-to-date list of Relying Parties with which the User has established a connection and, where applicable, all data exchanged;</p></li>
<li><p>The Wallet Instance MUST provide Users with a mechanism to request the erasure of personal attributes by a Relying Party pursuant to Article 17 of Regulation (EU) 2016/679, and to log each Erasure Request made.</p></li>
</ul>
<section id="wallet-attestation-requirements">
<h3>Wallet Attestation Requirements<a class="headerlink" href="#wallet-attestation-requirements" title="Link to this heading">¶</a></h3>
<p>Wallet Attestation contains information regarding the security level of the device hosting the Wallet Instance.
It primarily certifies the <strong>authenticity</strong>, <strong>integrity</strong>, <strong>security</strong>, <strong>privacy</strong>, and <strong>trustworthiness</strong> of a particular Wallet Instance.</p>
<p>The requirements for the Wallet Attestation are defined below:</p>
<ul class="simple">
<li><p>The Wallet Attestation MUST provide all the relevant information to attest to the <strong>integrity</strong> and <strong>security</strong> of the device where the Wallet Instance is installed.</p></li>
<li><p>The Wallet Attestation MUST be signed by the Wallet Provider that has authority over and is the owner of the Wallet Solution, as specified by the overseeing registration authority. This ensures that the Wallet Attestation uniquely links the Wallet Provider to this particular Wallet Instance.</p></li>
<li><p>The Wallet Provider MUST ensure the integrity, authenticity, and genuineness of the Wallet Instance, preventing any attempts at manipulation or falsification by unauthorized third parties. The Wallet Provider MUST also verify the Wallet Instance using the available OS Provider's API and MUST do so using the securest flow alloweded by the OS Provider's API. Examples include <em>Play Integrity API</em> for Android and <em>App Attest</em> for iOS.</p></li>
<li><p>The Wallet Provider MUST possess a revocation mechanism for the Wallet Instance, allowing the Wallet Provider to terminate service for a specific Instance at any time.</p></li>
<li><p>The Wallet Attestation MUST be securely bound to the Wallet Instance's ephemeral public key.</p></li>
<li><p>The Wallet Attestation MAY be used multiple times during its validity period, allowing for repeated authentication and authorization without the need to request new attestations with each interaction. However, it is RECOMMENDED that Wallet Instances avoid using the same attestation repeatedly, due to privacy concerns such as linkability between different interactions.</p></li>
<li><p>The Wallet Attestation MUST be short-lived and MUST have an expiration time, after which it MUST no longer be considered valid.</p></li>
<li><p>The Wallet Attestation MUST NOT be issued by the Wallet Provider if the authenticity, integrity, and genuineness of the Wallet Instance requesting it cannot be guaranteed.</p></li>
<li><p>Each Wallet Instance SHOULD be able to request multiple Wallet Attestations using different cryptographic public keys associated with them.</p></li>
<li><p>The Wallet Attestation MUST NOT contain information about the User in control of the Wallet Instance.</p></li>
<li><p>The Wallet Instance MUST secure a Wallet Attestation as a prerequisite for transitioning to the Operational state, as defined by <span class="xref std std-ref">ARF</span>.</p></li>
</ul>
<figure class="align-center" id="id64" style="width: 100%">
<a class="reference external image-reference" href="https://www.plantuml.com/plantuml/svg/VP8nJyCm48Lt_ugdTexOCw22OCY0GAeGOsMSerWuliY-fEg_9mrEPTAqw-VtNLxEtaJHGRh6AMs40rRlaS8AEgAB533H3-qS2Tu2zxPEWSF8TcrYv-mJzTOGNfzVnXXJ0wKCDorxydAUjMNNYMMVpug9OTrR7i22LlaesXlADPiOraToZWyBsgCsF-JhtFhyGyZJgNlbXVR1oX5R2YSoUdQYEzrQO1seLcfUeGXs_ot5_VzqYM6lQlRXMz6hsTccIbGHhGu2_hhfP1tBwHuZqdOUH6WuEmrKIeqtNonvXhq4ThY3Dc9xBNJv_rSwQeyfawhcZsTPIpKLKuFYSa_JyOPytJNk5m00"><img alt="_images/static_view_wallet_instance_attestation.svg" src="_images/static_view_wallet_instance_attestation.svg" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Wallet Solution Schema</span><a class="headerlink" href="#id64" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Throughout this section, the services used to attest genuineness of the Wallet Instance and the device in which it is installed are referred to as <strong>Key Attestation API</strong>. The Key Attestation API is considered in an abstract fashion and it is assumed to be a service provided by a trusted third party (i.e., the OS Provider's API) which is able to perform integrity checks on the Wallet Instance as well as on the device where it is installed.</p>
</div>
</section>
<section id="wscd-requirements">
<h3>WSCD Requirements<a class="headerlink" href="#wscd-requirements" title="Link to this heading">¶</a></h3>
<p>To guarantee the utmost security, the cryptographic keys associated with a Wallet Instance (e.g., used to generate the Wallet Attestation) MUST be securely generated and stored within the Wallet Secure Cryptographic Device (WSCD).
This ensures that only the User can access these keys, thus preventing unauthorized usage or tampering. The WSCD MAY be implemented using at least one of the approaches listed below:</p>
<ul class="simple">
<li><p><strong>Local Internal WSCD</strong>: The WSCD relies entirely on the device's native cryptographic hardware, such as the Secure Enclave on iOS, or the Trusted Execution Environment (TEE) and Strongbox on Android.</p></li>
<li><p><strong>Local External WSCD</strong>: The WSCD is hardware external to the User's device, such as a smart card compliant with <em>GlobalPlatform</em> and supporting <em>JavaCard</em>.</p></li>
<li><p><strong>Remote WSCD</strong>: The WSCD utilizes a remote Hardware Security Module (HSM).</p></li>
<li><p><strong>Local Hybrid WSCD</strong>: The WSCD involves a pluggable internal hardware component within the User's device, such as an <em>eUICC</em> that adheres to <em>GlobalPlatform</em> standards and supports <em>JavaCard</em>.</p></li>
<li><p><strong>Remote Hybrid WSCD</strong>: The WSCD involves a local component mixed with a remote service.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>At the current stage, the implementation profile defined in this document supports only the <strong>Local Internal WSCD</strong>. Future versions of this specification MAY include other approaches depending on the required Authenticator Assurance Level (<cite>AAL</cite>).</p>
</div>
<p>For more detailed information, please refer to <a class="reference internal" href="#wallet-instance-initialization-and-registration"><span class="std std-ref">Wallet Instance Initialization and Registration</span></a> and <a class="reference internal" href="#wallet-attestation-issuance"><span class="std std-ref">Wallet Attestation Issuance</span></a>  of this document.</p>
</section>
</section>
<section id="wallet-instance">
<h2>Wallet Instance<a class="headerlink" href="#wallet-instance" title="Link to this heading">¶</a></h2>
<p>The Wallet Instance establishes a strong and reliable mechanism for the User to engage in various digital transactions in a secure and privacy-preserving manner.</p>
<p>The Wallet Instance allows other entities within the ecosystem to establish trust with it, by consistently
presenting a Wallet Attestation during interactions with PID Providers,
(Q)EAA Providers, and Relying Parties. These verifiable attestations, provided by the Wallet Provider,
serve to authenticate the Wallet Instance itself, ensuring its reliability when engaging with other ecosystem actors.</p>
<section id="wallet-instance-lifecycle">
<h3>Wallet Instance Lifecycle<a class="headerlink" href="#wallet-instance-lifecycle" title="Link to this heading">¶</a></h3>
<p>The Wallet Provider is in charge of the implementation and provision of Wallet Instances also handling their entire lifecycle.</p>
<p>In this section, state machines are presented to explain the Wallet Instance and Digital Credential states and their transitions and relations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PID is a specialized Digital Credential type that has impacts on the Wallet Instance's lifecycle. The revocation of the PID MAY also have potential impacts on (Q)EAAs, if they were issued using the presentation of the PID.
When the distinction between PID and (Q)EAA is not needed, the term Digital Credential is used.</p>
</div>
<p>As shown in <a class="reference internal" href="#fig-wallet-instance-states"><span class="std std-numref">Fig. 3</span></a>, the Wallet Instance has four distinct states: <strong>Installed</strong>, <strong>Operational</strong>, <strong>Valid</strong>, and <strong>Uninstalled</strong>.
Each state represents a specific functional status and determines the actions that can be performed.</p>
<figure class="align-center" id="id65" style="width: 100%">
<span id="fig-wallet-instance-states"></span><a class="reference external image-reference" href="https://www.plantuml.com/plantuml/svg/XPBHIuH04CRVzwyOk9SAH8ipGaHESW-4kEpihg1wi7ElMzXRHLUY_lfMAvtMZlD5cUytttpZxgnMMQMQlI0xdZDW-r9zGCxgJSLBnGj9Y0OKWrZgjn0iXyby7hgEyrE_BLcLjM0cOBBLJw-iCy4rxJXNJbzRIJxuH9TJT-eI0W1FPozWvSMxj89XaWSFCSIBzBubXd8FjcOONIt-Wol-jbEQHa4xEhpkK5m_xcpWWctLAF6IhaUaET_V5AAel5VHiE3axfI68SHfQYTBwjkT51pCrltMlmv97BNjkFKR0wifZT5c7trCxDz6U9POrelO4RqvP3jU6n4egB4gnQlYiJWLKf7fyUF14bWQrHTBHwZv9_FEBmBVRhy2CcCorrV-2m00"><img alt="_images/Wallet_Instance_States.svg" src="_images/Wallet_Instance_States.svg" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Wallet Instance Lifecycle.</span><a class="headerlink" href="#id65" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Wallet Provider MUST ensure the security and reliability of the Wallet Instances. To achieve this, the Wallet Provider MUST periodically check the Wallet Instances security and compliance status.</p>
</div>
<section id="transition-to-installed">
<h4>Transition to Installed<a class="headerlink" href="#transition-to-installed" title="Link to this heading">¶</a></h4>
<p>The state machine begins with the Wallet Instance installation (<strong>WI INST</strong>) transition, where Users download and install a Wallet Instance provided by the Wallet Provider using the
official app store of their device's operating system (this ensures authenticity via system checks), leading to the <strong>Installed</strong> state.</p>
<p>When the state is <strong>Installed</strong>, the Wallet Instance MUST interact only with the Wallet Provider to be activated. When the revocation of the Wallet Instance occurs, the Wallet Instance MUST go back from <strong>Operational</strong> or <strong>Valid</strong> to <strong>Installed</strong>. The revocation marks the Wallet Cryptographic Hardware Key, registered during activation
(see <a class="reference internal" href="#transition-to-operational"><span class="std std-ref">Transition to Operational</span></a>), as not usable anymore. Revocation can occur in the following cases:</p>
<ul class="simple">
<li><p>for technical security reasons (e.g., relating to the compromise of cryptographic material);</p></li>
<li><p>in case of explicit User requests (e.g., due to loss, or theft of the Wallet Instance);</p></li>
<li><p>death of the User;</p></li>
<li><p>illegal activities reported by Judicial or Supervisory Bodies.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While for the ARF the revocation of the Wallet Instance is accomplished by revoking the Wallet Attestation (see Topic 9 and Topic 38 in Annex 2),
in this specification the revocation is managed differently. Being the Wallet Attestation short-lived, it does not have a status management mechanism.
For this reason, the Wallet Instance revocation transition is accomplished by deleting the Wallet Cryptographic Hardware Key from the WSCD of the Wallet
Instance and from the account associated with the User. This transition is completed when the Wallet Instance is online.</p>
</div>
</section>
<section id="transition-to-operational">
<h4>Transition to Operational<a class="headerlink" href="#transition-to-operational" title="Link to this heading">¶</a></h4>
<p>After installation, the User opens the Wallet Instance and an activation begins (<strong>WI ACT</strong>).
At this stage, a User account MUST be created with the Wallet Provider and associated with the Wallet Instance through the Wallet Cryptographic
Hardware Key Tag, subject to obtaining the User's consent (see <a class="reference internal" href="#wallet-instance-initialization-and-registration"><span class="std std-ref">Wallet Instance Initialization and Registration</span></a> for more details).
This association allows the User to directly request Wallet Instance revocation from the Wallet Provider, and it also allows the Wallet Provider to
revoke the Wallet Instance associated with that User.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As a result of the User account creation, an authentication mechanism MUST be set for the User to interact with the Wallet Provider portal.
This specification mandates the use of at least a second-factor for User authentication.</p>
</div>
<p>As part of the activation, the Wallet Provider MUST evaluate the operating system and general technical capabilities of the device to check compliance
with the technical and security requirements, and the authenticity and integrity of the installed Wallet Instance.
Upon successful verification, the Wallet Provider MUST issue at least one valid Wallet Attestation to the Wallet Instance, therefore the Wallet Instance enters the <strong>Operational</strong> state.</p>
<p>In addition, if not already done, Users MUST set their preferred method of unlocking their Wallet Instance; this MAY be accomplished by entering a
personal identification number (PIN) or by utilizing biometric authentication, such as fingerprint or facial recognition, according to personal
preferences and device's capabilities. Please refer to <a class="reference internal" href="#wallet-attestation-issuance"><span class="std std-ref">Wallet Attestation Issuance</span></a>.</p>
<p>In the <strong>Operational</strong> state, Users can request the issuance of PID (<strong>PID ISS</strong>) or (Q)EAAs if the PID is not required in the issuance
(<strong>(Q)EEA ISS</strong>). In addition, if the Digital Credentials are (Q)EEAs and for the presentation they do not require the PID, they can be presented
without transitioning the Wallet Instance to another state (<strong>(Q)EEA PRE</strong> transition).</p>
<p>A <strong>Valid</strong> Wallet Instance MUST transition back to the <strong>Operational</strong> state due to <strong>PID EXP/REV/DEL</strong> transition, when the associated PID expires, is revoked by its Provider or either deleted by the User.</p>
</section>
<section id="transition-to-valid">
<h4>Transition to Valid<a class="headerlink" href="#transition-to-valid" title="Link to this heading">¶</a></h4>
<p>A transition to the Valid state occurs only when the Wallet Instance obtains a valid PID (<strong>PID ISS</strong>). In this state, Users can obtain and present
new (Q)EAAs (<strong>(Q)EAA ISS/PRE</strong>), and present the PID (<strong>PID PRE</strong>). Please refer to <a class="reference internal" href="pid-eaa-issuance.html#pid-q-eaa-issuance"><span class="std std-ref">PID/(Q)EAA Issuance</span></a> and <a class="reference internal" href="pid-eaa-presentation.html#pid-q-eaa-presentation"><span class="std std-ref">PID/(Q)EAA Presentation</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Users can have only one Wallet Instance in <strong>Valid</strong> state for the same Wallet Solution. Thus, when a User installs and obtains a PID on a new Wallet
Instance of the same Wallet Solution from the same Wallet Provider, the PID in the previous Wallet Instance MUST be revoked and the Wallet Instance became
<strong>Operational</strong>.</p>
</div>
</section>
<section id="transition-to-uninstalled">
<h4>Transition to Uninstalled<a class="headerlink" href="#transition-to-uninstalled" title="Link to this heading">¶</a></h4>
<p>Across all states, <strong>Installed</strong>, <strong>Activated</strong>, <strong>Operational</strong>, or <strong>Valid</strong>, the Wallet Instance can be removed entirely through the Wallet Instance
uninstall (<strong>WI UNINST</strong>) transition, leading to the <strong>Uninstalled</strong> state. If a Wallet Instance is <strong>Uninstalled</strong> it ends its lifecycle.</p>
</section>
</section>
<section id="wallet-instance-lifecycle-management">
<h3>Wallet Instance Lifecycle Management<a class="headerlink" href="#wallet-instance-lifecycle-management" title="Link to this heading">¶</a></h3>
<p>While <a class="reference internal" href="#fig-wallet-instance-states"><span class="std std-numref">Fig. 3</span></a> shows the different states a Wallet Instance may acquire during its lifecycle,
<a class="reference internal" href="#fig-wallet-instance-lifecycle"><span class="std std-numref">Fig. 4</span></a> shows the point of view of Wallet Instances and Wallet Providers in managing the Wallet Instance lifecycle
and the effect on their local storage.</p>
<figure class="align-center" id="id66" style="width: 100%">
<span id="fig-wallet-instance-lifecycle"></span><a class="reference external image-reference" href="https://www.plantuml.com/plantuml/svg/dP9Vgvim6CRl_HIPd0k5ddgpgq7XE0sSGhUAUbO6WnBDYnLYuf9NkpBstPUurPLEs9yRBzuyloV-aZmPP1g7JdYlMbcBWGCv8VRcJHHfTbutBPw6QZ2WQoKH9AvhrKMzOD8nZmQvQAieUVsOkT7BkrtKCOEWxUYOM8Ar4lIwT_tFsvGUYvBcT5z-p6WGUbxnl3ySCveN-_V7R9-NURmjtJpcF0THiYRmUUMlo0F25qoKK7hZAyra0sueRFVYiC2B0B8XAJCdu3ix2KBR-bODaZDz2OPgHVm34mAGRAL19ciWrrK_95yzuX5INAn85x3wyq8whh4T6RPAaayoE6n9d9IXRuD--0lb81RG74PLtw8v_N15BJkVMbe5PuDAh_p2Vba3SxttpRkngMziCgt6beE-ixd-K0FoVrqqZF_cSgSocP3VLEP8q0zkFMN8I3ReffND55ezc5wt21jVgqgXXPny3k87yBCsfJjQqWbmhuKrPkDUJkY2pdeE9ZcD5uDJShhhyv-YBZbTxVblTjSmphk_PEbovHD8FdJYEm00"><img alt="_images/wallet_instance_lifecycle.svg" src="_images/wallet_instance_lifecycle.svg" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Wallet Instance Lifecycle Management.</span><a class="headerlink" href="#id66" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Through a Wallet Instance in an <strong>Installed</strong> state, a User is able to start the <strong>Wallet Instance Activation</strong> (<strong>WI ACT</strong>).
As a result, the Wallet Instance MUST create a Wallet Cryptographic Hardware Key pair. In addition, if not already done,
Users MUST set their preferred method of unlocking their Wallet Instance. As a result of the <strong>Wallet Instance Revocation</strong> (<strong>WI REV</strong>), the Wallet Instance MUST
delete the Wallet Cryptographic Hardware Key pairs.</p>
<p>A Wallet Provider instead is responsible for:</p>
<ul class="simple">
<li><p><strong>Wallet Instance Activation</strong> (<strong>WI ACT</strong>): a User account MUST be created and associated with the Wallet Instance through the Wallet Cryptographic Hardware Key Tag. As a result of the User account creation, an authentication mechanism of at least two factors MUST be set for the User to interact with the Wallet Provider portal.</p></li>
<li><p><strong>Wallet Instance Revocation</strong> (<strong>WI REV</strong>): for technical security reasons or triggered by external entities (e.g., Users and Supervisory Bodies) the Wallet Cryptographic Hardware Key Tag MUST be deleted from the User account.</p></li>
<li><p><strong>Data Purging</strong>: through an explicit request of Users, the User account at the Wallet Provider MUST be removed from the local storage.</p></li>
</ul>
</section>
</section>
<section id="wallet-instance-functionalities">
<h2>Wallet Instance Functionalities<a class="headerlink" href="#wallet-instance-functionalities" title="Link to this heading">¶</a></h2>
<p>A Wallet Instance, MUST support the following functionalities:</p>
<blockquote>
<div><ul class="simple">
<li><p>Wallet Registration (detailed in <a class="reference internal" href="#wallet-instance-initialization-and-registration"><span class="std std-ref">Wallet Instance Initialization and Registration</span></a>),</p></li>
<li><p>Wallet Attestation Issuance (detailed in <a class="reference internal" href="#wallet-attestation-issuance"><span class="std std-ref">Wallet Attestation Issuance</span></a>),</p></li>
<li><p>Wallet Revocation (detailed in <a class="reference internal" href="#wallet-instance-revocation"><span class="std std-ref">Wallet Instance Revocation</span></a>) and</p></li>
<li><p>Deletion of presented attributes (detailed in <a class="reference internal" href="#user-s-attributes-deletion"><span class="std std-ref">User's Attributes Deletion</span></a>).</p></li>
</ul>
</div></blockquote>
<p>Each functionality is described in detail in the following sections.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The details provided below are non-normative and are intended to clarify the functionalities of the Wallet Instance Registration. The actual implementation may vary based on the specific use case and requirements of the Wallet Provider.</p>
</div>
<section id="wallet-instance-initialization-and-registration">
<h3>Wallet Instance Initialization and Registration<a class="headerlink" href="#wallet-instance-initialization-and-registration" title="Link to this heading">¶</a></h3>
<p>This process allows the User who has just installed the Wallet Instance application to register the Wallet Instance with the Wallet Provider backend. During this process, the Wallet Instance application will request a security and integrity assertion from the OS manufacturer, which also binds a long-lived key pair stored in a proper secure storage within the device itself. This assertion will be validated by the Wallet Provider, and if the validation is successful, the Wallet Provider will authenticate the Wallet Instance. For details see <a class="reference internal" href="mobile-application-instance.html#mobile-application-instance-initialization"><span class="std std-ref">Mobile Application Instance Initialization</span></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>During the registration phase of the Wallet Instance with the Wallet Provider it is also necessary to associate the Wallet Instance with a specific User, authenticating the User with the Wallet Provider. The authentication mechanism is at the discretion of the Wallet Provider and it will not be addressed within these guidelines, as each Wallet Provider may have its User authentication systems already implemented.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Wallet Provider SHOULD associate the Wallet Instance (through the <code class="docutils literal notranslate"><span class="pre">hardware_key_tag</span></code> identifier) with a specific User uniquely identified within the Wallet Provider's systems. This will be useful for the lifecycle of the Wallet Instance and for a future revocation. For details see <a class="reference internal" href="mobile-application-instance.html#mobile-application-instance"><span class="std std-ref">Mobile Application Instance</span></a>.</p>
</div>
</section>
<section id="wallet-attestation-issuance">
<span id="wallet-attestation-rst"></span><h3>Wallet Attestation Issuance<a class="headerlink" href="#wallet-attestation-issuance" title="Link to this heading">¶</a></h3>
<p>This section describes how the Wallet Provider issues a Wallet Attestation.</p>
<figure class="align-center" id="id67" style="width: 100%">
<a class="reference external image-reference" href="https://www.plantuml.com/plantuml/svg/VLHFRnC_4BtxKupSmo-LyhiWmQ4Ig5LLsWg4ehR09L8qkvxiMjcC5tisfNnwx4s9jy7qiehjDt_UcpSv3u9UXcsdS137mxOYhrfh2DREIUL-gl_w2B2rxP55AQp5UT1V0taD66084Jz1WFwENKS2jnm4kQOHXNqFBr6Vw0akH2Y2n3g6YyLjs4DH0fo4tbjk6a_4nUmBxtRMa8SAwmsn6KEhUgEKIXtz_o5MF8Cx-Z5G441WUWJNazyNanPboJw-May14FPPfmqbedQ7GgbtfUBdEUTbI_K6x1ek_LClhl7OjxQ66_Jc4Jr18hRa1snWfdNxVBlQqDDAiD7w56m0tA7jiEf8JJDV4wS6KqCCrBUqZSSEOYZqQ7tATxWT4_P3fVKS_hhsTXSBAUNP2O7RaKyavb4UEFbyUttpS7rtTVL5xPaS2se39C71hK5QWeza_gY6RC1LWfR1Ie0j2HeKLCGcLJgGYNMoz5gpIoxGMT1nJF4p8ZDjM7iARGxOOvwroRU6fecA0aPqtLbYMQN-LYs6Ley6kR-vUFFstUoGR0v5IK-BIL-Pzy8jbZoPTh0Demm-be3ta4wpMQcdEHGjChtE4yrjeOIp8aULdh9aAHIpfRKkyIfu_p2yHojjASySocJdaALTSedRFnGVDIApBvYjNtRsn6NtnEOL0YyzbzSX7Slha1Rxw0yiROHbAnOx-ulCk0Qx-Dke8LXkYYFCEv5z_Yt5e53MgF1OKBi4A-fVH9RrJewTW2yzbPqmMS6opA5t7EXuAQVd6AlEYSsmxNu3"><img alt="_images/wallet_instance_acquisition.svg" src="_images/wallet_instance_acquisition.svg" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Sequence Diagram for Wallet Attestation acquisition</span><a class="headerlink" href="#id67" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p><strong>Step 1</strong>: The User initiates a new operation that necessitates the acquisition of a Wallet Attestation.</p>
<p><strong>Steps 2-3</strong>: The Wallet Instance MUST:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Verify the existence of Cryptographic Hardware Keys. If none exist, Wallet Instance re-initialization is required.</p></li>
<li><p>Generate an ephemeral asymmetric key pair for Wallet Attestation (<code class="docutils literal notranslate"><span class="pre">ephemeral_key_pub</span></code>, <code class="docutils literal notranslate"><span class="pre">ephemeral_key_priv</span></code>), linking the public key to the attestation.</p></li>
<li><p>Verify the Wallet Provider's federation membership and retrieve its metadata.</p></li>
</ol>
</div></blockquote>
<p><strong>Steps 4-6 (Nonce Retrieval)</strong>: The Wallet Instance solicits a <code class="docutils literal notranslate"><span class="pre">nonce</span></code> from the <a class="reference internal" href="#nonce-endpoint"><span class="std std-ref">Nonce Endpoint</span></a> of the Wallet Provider Backend. This <code class="docutils literal notranslate"><span class="pre">nonce</span></code> is required to be unpredictable and serves as the main defense against replay attacks.
The <code class="docutils literal notranslate"><span class="pre">nonce</span></code> MUST be produced in a manner that ensures its single-use within a predetermined time frame.</p>
<p>Upon a successful request, the Wallet Provider generates and returns the nonce value to the Wallet Instance.</p>
<p><strong>Step 7</strong>: The Wallet Instance performs the following actions:</p>
<ul class="simple">
<li><p>Creates <code class="docutils literal notranslate"><span class="pre">client_data</span></code>, a JSON object that includes the <code class="docutils literal notranslate"><span class="pre">nonce</span></code> and the thumbprint of <code class="docutils literal notranslate"><span class="pre">ephemeral_key_pub</span></code> JWK.</p></li>
<li><p>Computes <code class="docutils literal notranslate"><span class="pre">client_data_hash</span></code> by applying the <code class="docutils literal notranslate"><span class="pre">SHA256</span></code> algorithm to the <code class="docutils literal notranslate"><span class="pre">client_data</span></code>.</p></li>
</ul>
<p>Below is a non-normative example of the <code class="docutils literal notranslate"><span class="pre">client_data</span></code> JSON object.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;nonce&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;i4ThI2Jhbu81i8mqyWEuDG5t&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;jwk_thumbprint&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;vbeXJksM45xphtANnCiG6mCyuU4jfGNzopGuKvogg9c&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Steps 8-10</strong>: The Wallet Instance:</p>
<ul class="simple">
<li><p>produces an <code class="docutils literal notranslate"><span class="pre">hardware_signature</span></code> value by signing the <code class="docutils literal notranslate"><span class="pre">client_data_hash</span></code> with the Wallet Hardware's private key, serving as a proof of possession for the Cryptographic Hardware Keys.</p></li>
<li><p>requests the Key Attestation API to create an <code class="docutils literal notranslate"><span class="pre">key_attestation</span></code> value linked to the <code class="docutils literal notranslate"><span class="pre">client_data_hash</span></code>.</p></li>
<li><p>receives a signed <code class="docutils literal notranslate"><span class="pre">key_attestation</span></code> value from the Key Attestation API, authenticated by the OEM.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">key_attestation</span></code> is a custom payload generated by Key Attestation API, signed by device OEM and encoded in base64 to have uniformity between different devices.</p>
</div>
<p><strong>Steps 11-12 (Wallet Attestation Issuance Request)</strong>: The Wallet Instance:</p>
<ul class="simple">
<li><p>Constructs the Wallet Attestation Request in the form of a JWT. This JWT includes the <code class="docutils literal notranslate"><span class="pre">key_attestation</span></code>, <code class="docutils literal notranslate"><span class="pre">hardware_signature</span></code>, <code class="docutils literal notranslate"><span class="pre">nonce</span></code>, <code class="docutils literal notranslate"><span class="pre">hardware_key_tag</span></code>, <code class="docutils literal notranslate"><span class="pre">cnf</span></code> and other configuration related parameters (see <span class="xref std std-ref">Table of the Wallet Attestation Request Body</span>) and is signed using the private key of the initially generated ephemeral key pair.</p></li>
<li><p>Submits the Wallet Attestation Request to the <a class="reference internal" href="#wallet-attestation-issuance-endpoint"><span class="std std-ref">Wallet Attestation Issuance Endpoint</span></a> of the Wallet Provider Backend.</p></li>
</ul>
<p>The Wallet Instance MUST send the signed Wallet Attestation Request JWT as an <code class="docutils literal notranslate"><span class="pre">assertion</span></code> parameter in the body of an HTTP request to the Wallet Provider's <a class="reference internal" href="#wallet-attestation-issuance-endpoint"><span class="std std-ref">Wallet Attestation Issuance Endpoint</span></a>.</p>
<p><strong>Steps 13-17</strong>: The Wallet Provider Backend evaluates the Wallet Attestation Request and MUST perform the following checks:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The request MUST include all required HTTP header parameters as defined in <a class="reference internal" href="#wallet-attestation-issuance-request"><span class="std std-ref">Wallet Attestation Issuance Request</span></a>.</p></li>
<li><p>The signature of the Wallet Attestation Request MUST be valid and verifiable using the provided <code class="docutils literal notranslate"><span class="pre">jwk</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">nonce</span></code> value MUST have been generated by the Wallet Provider and not previously used.</p></li>
<li><p>A valid and currently registered Wallet Instance associated with the provided MUST exist.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">client_data</span></code> MUST be reconstructed using the <code class="docutils literal notranslate"><span class="pre">nonce</span></code> and the <code class="docutils literal notranslate"><span class="pre">jwk</span></code> public key.  The <code class="docutils literal notranslate"><span class="pre">hardware_signature</span></code> parameter value is then validated using the registered Cryptographic Hardware Key's public key associated with the Wallet Instance.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">key_attestation</span></code> MUST be validated according to the device manufacturer's guidelines.  The specific checks performed by the Wallet Provider are detailed in the operating system manufacturer's documentation.</p></li>
<li><p>The device in use MUST be free of known security flaws and meet the minimum security requirements defined by the Wallet Provider.</p></li>
<li><p>The URL in the <code class="docutils literal notranslate"><span class="pre">iss</span></code> parameter MUST match the Wallet Provider's URL identifier.</p></li>
</ol>
</div></blockquote>
<p>Upon successful completion of all checks, the Wallet Provider issues a Wallet Attestation valid for a maximum of 24 hours.</p>
<p><strong>Step 18 (Wallet Attestation Issuance Response)</strong>:  Upon successful completion, the Wallet Provider MUST return a confirmation response using status code 200 and Content-Type <code class="docutils literal notranslate"><span class="pre">application/json</span></code>, containing the Wallet Attestations signed by the Wallet Provider. The Wallet provider MUST return the Wallet Attestation in at least three formats: JWT, SD-JWT and mdoc. The Wallet Instance will then perform security and integrity verification of the Wallet Attestations received in addition to trust verification of its Issuer.</p>
<p>Below is a non-normative example of the response.</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>

<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;wallet_attestations&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;jwt&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;wallet_attestation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ey...&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dc+sd-jwt&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;wallet_attestation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ey...&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mso_mdoc&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;wallet_attestation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;omppc3N1ZXJBdXRohEOhASahG...ArQwggKwMIICVqADAgEC&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="wallet-instance-revocation">
<span id="wallet-revocation-rst"></span><h3>Wallet Instance Revocation<a class="headerlink" href="#wallet-instance-revocation" title="Link to this heading">¶</a></h3>
<p>This section describes the involved entities and modalities to request a Wallet Instance revocation.</p>
<p>The Wallet Provider MUST ensure the security and reliability of Wallet Instances, keeping them updated and compliant with security requirements. When, for technical security reasons (e.g., relating to the compromise of cryptographic material) the security of the Wallet Instance is compromised, the Wallet Provider MUST revoke the Wallet Instance.</p>
<p>As shown in <a class="reference internal" href="#fig-wallet-instance-revoc-entities"><span class="std std-numref">Fig. 6</span></a>, other actors MAY trigger the Wallet Instance revocation process:</p>
<ul class="simple">
<li><p><strong>Users</strong>, connecting to the Wallet Provider’s web portal from their Wallet Instance or using an external browser.</p></li>
<li><p><strong>PID Providers</strong> when notified by the Authentic Source of the PID (ANPR) of the User’s death.</p></li>
<li><p><strong>Legal Authorities or the Supervisory Body</strong> in cases of proven illegal activities.</p></li>
</ul>
<figure class="align-center" id="id68" style="width: 80%">
<span id="fig-wallet-instance-revoc-entities"></span><a class="reference external image-reference" href="https://www.plantuml.com/plantuml/svg/fL9TZn8z5BwVNt5URbusSPSRhxnQ5oOHuog1tHYJJIPbMk74JZksf-1e_E-UKmiguvqafFIXpyVvk8sa0gNELl-XQstI1lP4VNmncmLrlDaXxTCsHHDQxyWukcbzD-kjSiAvZgGjRcVpvzShWHxltymw5Sa4XfgvxthlXDEBVlLgkQYRpKEzhjyzV5ZLqwkgMfaGlPkA_ZEOFF8nuRDsX3I0FpfqEw2zWIVtNbbh29QEyxhMJ9XyvvFJAWpJO_wlYGCxTymlRpVvFhc2RnNmvnpdz1wBbZ0kr1cIxxroQcSYIBx_8ooGsw4ip8FHh8FAHixnL-q--0DghkealIh0IRhS8rnOWt8QZcOBR7d0reZ3zwhwPQ0IxSMyRQ9F8QT_UO9Waw6HXpGM5570RIA-ayzTNSQOJCYENQbKu8Eog6K0d8YI13YxD_MNdmbymAz6Drkl1mbmHY3F3aqyPTYaNWg9FWnmnw-ps-kaiKLbeH1fO9FVQiGSJ2fOBaQTowdZ7wdbcTnBr-Db0wjgRMpPiei1ZOSFQtFmhIBqZdz-PYyI2L4OSSUR9EHFvdAg4a84fB1_3J5UW7Extdh2ZuECMzRroMcZQ5-iHrCRPoZq9UCx6KvBU432dFxME9qw-mC0"><img alt="_images/wallet_instance_revocation.svg" src="_images/wallet_instance_revocation.svg" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">Entities involved in the Wallet Instance revocation process.</span><a class="headerlink" href="#id68" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The flow for the Wallet Instance Revocation triggered by the User is detailed below.</p></li>
<li><p>The endpoint used by the PID Provider is detailed in the Wallet Provider Catalogue of e-Service PDND Catalogue (see Section <a class="reference internal" href="e-service-pdnd-catalogue.html#wp-catalogue"><span class="std std-ref">Wallet Provider Catalogue</span></a> for technical details).</p></li>
<li><p>The flow for Authorized Entities (e.g., Supervisory Bodies) is out of scope of this specification, it will be managed by each Wallet Provider.</p></li>
</ul>
</div>
<section id="wallet-instance-revocation-request">
<h4>Wallet Instance Revocation Request<a class="headerlink" href="#wallet-instance-revocation-request" title="Link to this heading">¶</a></h4>
<p>Users MAY request the Wallet Instance revocation by:</p>
<ul class="simple">
<li><p><em>Selecting the revocation functionality from their Wallet Instance</em>: this functionality may be used by Users before changing their phone.</p></li>
<li><p><em>Using an external user agent</em>: this covers cases where Users lose their device, and so their access to their Wallet Instance.</p></li>
</ul>
<p>In both cases, by using the Wallet Provider portal:</p>
<ul class="simple">
<li><p>Users MUST authenticate with at least a second-factor authentication mechanism, or have an active session that meets this requirement.</p></li>
<li><p>The Wallet Provider MUST allow Users to view the state of their Wallet Instances associated with their authenticated session and ask for revocation, sending a Wallet Instance Retrieval or Revocation Request, as applicable, to the <a class="reference internal" href="#wallet-instance-management-endpoint"><span class="std std-ref">Wallet Instance Management Endpoint</span></a> of the Wallet Provider Backend.</p></li>
</ul>
<p>Below is a non-normative example of a Wallet Instances Retrieval Request.</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">GET</span> <span class="nn">/wallet-instances</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">walletprovider.example.com</span>
</pre></div>
</div>
<p>Upon a successful retrieval, the Wallet Provider MUST return a confirmation response, with the status of all Wallet Instances associated with the User.
Below is a non-normative example of a Wallet Instances Retrieval Response.</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
<span class="na">Cache-Control</span><span class="o">:</span> <span class="l">no-store</span>

<span class="p">[</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;f7b2a8d9&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ACTIVE&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;issued_at&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-03-12T10:00:00Z&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;g8b235c4&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;REVOKED&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;issued_at&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2024-02-28T15:30:00Z&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Once the User identifies the Wallet Instance to be revoked, a Wallet Instance Revocation Request can be sent to the endpoint, including the Wallet Instance ID as a path parameter.
Below is a non-normative example of a Wallet Instance Revocation Request.</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">PATCH</span> <span class="nn">/wallet-instances/{f7b2a8d9}</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">wallet-provider.example.org</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>

<span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;REVOKED&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="wallet-instance-revocation-response">
<h4>Wallet Instance Revocation Response<a class="headerlink" href="#wallet-instance-revocation-response" title="Link to this heading">¶</a></h4>
<p>Upon a successful revocation, the Wallet Provider MUST return a confirmation response.
Below is a non-normative example of a Wallet Instance Revocation Response.</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">204</span> <span class="ne">No Content</span>
</pre></div>
</div>
</section>
<section id="revocation-check-mechanisms">
<h4>Revocation Check Mechanisms<a class="headerlink" href="#revocation-check-mechanisms" title="Link to this heading">¶</a></h4>
<p>The verification of the Wallet Instance validity MUST be performed:</p>
<ul class="simple">
<li><p><strong>During Digital Credential issuance or presentation phase</strong> by the Credential Issuers and Relying Parties, respectively. Only Wallet Instances in Operational or Valid state have valid Wallet Attestations. Thus, the verification of the validity of a Wallet Instance is indirectly performed by Credential Issuers and Relying Parties by checking the presence of a valid Wallet Attestation (i.e. not expired and signed by a trusted Wallet Provider). During proximity presentation the Wallet Instance might not be able to fetch a fresh Wallet Attestation, in this case, the Wallet Instance SHOULD send the latest version of the Wallet Attestation. It is left up to the Relying Party to determine whether a presentation with a valid but expired Wallet Attestation is valid or not.</p></li>
<li><p><strong>During the validity period of the Digital Credential</strong>  by the Credential Issuers. Indeed, if the Wallet Instance is revoked, the PID hosted within it MUST be revoked. Any other Digital Credential obtained through the presentation of the PID MUST therefore be revoked too. In the current version of the specification, Credential Issuers are directly notified of a Wallet Instance revocation by the Wallet Provider using a PDND e-service.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With the introduction of the <strong>Wallet Trust Evidence (WTE)</strong>, this section will be updated accordingly.</p>
</div>
</section>
</section>
<section id="user-s-attributes-deletion">
<h3>User's Attributes Deletion<a class="headerlink" href="#user-s-attributes-deletion" title="Link to this heading">¶</a></h3>
<p>This Wallet Instance functionality allows Users to obtain a list of all Relying Parties towards which attributes that can uniquely identify Users (e.g., the tax_id_code claim of the PID) have been presented. Subsequently Users may request deletion of all attributes presented to a Relying Party of their choice. Below the high level flow regarding this interaction is presented.</p>
<figure class="align-center" id="id69" style="width: 100%">
<a class="reference external image-reference" href="https://www.plantuml.com/plantuml/png/RLBDZjD03BxdAQozS67t0Nf0ksABn0KX5iI5YvCuxOZfE8mzBNrxx2bDcBAtTFpv-_7NHr7CMWwnmwASog6dtE6WdE7kcr2-0nGeOezTpx_1dzu8FDCn3DJDjXg6C6DIkFkECPB2nsICQQ2wYFCCBSe9u6b7II_Cs54QmQWl_5yedaFQmMVRERURsunICi4sZHp-hXFDsg8-q4WPDN1ouBmW9qSkKb0ZmVqxTxWnpqV-IO2gEVH52KQAL3ccaWR_m1ZC3pZSjtnx0ozxFa4Cei1JupoGm8yK4imiGYBEnDFrU4zNcLiRBwOwAEYUsZk0ij5b-bL8wdZrnzFgMbP_ddRJafZmzhqzLH93EWJkhz9r93Cd8RzEOYNW8sMVsc-0hwPwqp1mhnYIrBcxMXkw71wcp0UVLCI154TKDC__HpI4b-EwtHh3hRsg77dd5_vNT4csT8GRFp3wD_azNe4sKRsBjnMw96vhm6A2ISE0Ib8pUACF5Jb5Fi70Dat63IS3BWZOeq1FzY9b64XaAZ6sTED3Uu5gOtN-x7tJMhM7xxaONdcHMRPg-2LkKsp1fVFRV_CdrZ2TBqoFPgKSuXy0"><img alt="_images/user%27s_data_deletion_flow.svg" src="_images/user%27s_data_deletion_flow.svg" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Sequence Diagram for Deletion of User's Attributes</span><a class="headerlink" href="#id69" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p><strong>Step 1:</strong> The User requests the deletion of attributes invoking the Wallet Instance’s attribute deletion function.</p>
<p><strong>Step 2:</strong> The Wallet Instance collects all transaction data and shows the User the list of Relying Parties with which it has had interactions throughout the Wallet Instance lifecycle and are in possession of User's attributes. The Wallet Instance SHOULD filter the transaction logs so that only the Relying Parties which have had access to attributes uniquely identifying the User are shown.</p>
<p><strong>Step 3:</strong> The User selects the target Relying Party for attributes deletion.</p>
<p><strong>Steps 4 - 5:</strong> The Wallet Instance obtains the Relying Party Entity Configuration at the Federation ./well-known/ endpoint. The URL or the Erasure Endpoint (<code class="docutils literal notranslate"><span class="pre">erasure_endpoint</span></code>) can be found inside the metadata parameter.</p>
<dl class="simple">
<dt><strong>Step 6:</strong> The Wallet Instance logs the Erasure Request’s relevant information. These logs MUST include at least:</dt><dd><ul class="simple">
<li><p>the date of request,</p></li>
<li><p>the Relying Party to which the request was made,</p></li>
<li><p>the attributes requested to be removed.</p></li>
</ul>
</dd>
</dl>
<p><strong>Steps 7 - 8:</strong> The Wallet Instance redirects the User to the Erasure Endpoint. It MUST also ensure that a callback mechanism to allow the User-Agent to notify the Wallet Instance (and thus the User) after the Erasure Response is present. Details on the Erasure Request can be found in <a class="reference internal" href="relying-party-solution.html#erasure-request"><span class="std std-ref">Erasure Request</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Relying Party web page will authenticate the User with an appropriate level of assurance using any method such as SPID/CIE or the PID presentation. The specific mechanism used for authentication is left to the Relying Party. Upon authenticating the User, the Relying Party MAY prompt the User to perform additional steps needed for the deletion of attributes, e.g., it might require the User to confirm the deletion operation.</p>
</div>
<p><strong>Step 9:</strong> Upon successful authentication of the User the Relying Party MUST delete all attributes bound to the User in its possession.</p>
<p><strong>Step 10:</strong> The Relying Party returns the Erasure Response in the form of an HTTP Response to the User-Agent and includes the callback URL if provided in the Erasure Request. Details on the Erasure Response can be found in <a class="reference internal" href="relying-party-solution.html#erasure-response"><span class="std std-ref">Erasure Response</span></a>.</p>
<p><strong>Steps 11 - 12:</strong>  The User-Agent uses the implemented method to return the Erasure Response to the Wallet Instance. Finally, the User is notified via the Wallet Instance regarding the Erasure Response outcome.</p>
</section>
</section>
<section id="wallet-provider-endpoints">
<h2>Wallet Provider Endpoints<a class="headerlink" href="#wallet-provider-endpoints" title="Link to this heading">¶</a></h2>
<p>The Wallet Provider, responsible for delivering a Wallet Solution, MUST expose the endpoints to support trust establishment and essential Wallet Instance functionalities. These include the <code class="docutils literal notranslate"><span class="pre">/.well-known/openid-federation</span></code> Federation Endpoint which MUST adhere to the OpenID Federation 1.0 specification to reliably establish trust with the Wallet Provider’s as well as, endpoints for Wallet Instance registration, nonce generation (required for registration), attestation issuance, and revocation. Aside from the Federation endpoint, the implementation details of the others are left to the Wallet Provider’s discretion.</p>
<section id="federation-endpoint">
<h3>Federation Endpoint<a class="headerlink" href="#federation-endpoint" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">/.well-known/openid-federation</span></code> endpoint serves as the discovery mechanism for trust establishment by retrieving the Wallet Provider Entity Configuration.</p>
<section id="wallet-provider-entity-configuration">
<h4>Wallet Provider Entity Configuration<a class="headerlink" href="#wallet-provider-entity-configuration" title="Link to this heading">¶</a></h4>
<p>An HTTP GET request to the Federation endpoint allows the retrieval of the Wallet Provider Entity Configuration.</p>
<p>The returned Entity Configuration of the Wallet Provider MUST contain the attributes described in the sections below.</p>
<p>The Wallet Provider Entity Configuration is a signed JWT containing the public keys and supported algorithms of the Wallet Provider. It is structured in accordance with the <a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a> and the <span class="xref std std-ref">Trust Model</span> outlined in this specification.</p>
</section>
<section id="wallet-provider-entity-configuration-jwt-header">
<h4>Wallet Provider Entity Configuration JWT Header<a class="headerlink" href="#wallet-provider-entity-configuration-jwt-header" title="Link to this heading">¶</a></h4>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Key</strong></p></th>
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>alg</p></td>
<td><p>Algorithm used to verify the token signature. It MUST be one of the possible values indicated in <a class="reference internal" href="algorithms.html#supported-algs"><span class="std std-ref">Cryptographic Algorithms</span></a> (e.g., ES256).</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-odd"><td><p>kid</p></td>
<td><p>Thumbprint of the public key used for the signature.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a> and <span class="target" id="index-0"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7638.html"><strong>RFC 7638</strong></a>.</p></td>
</tr>
<tr class="row-even"><td><p>typ</p></td>
<td><p>Media type, set to <code class="docutils literal notranslate"><span class="pre">entity-statement+jwt</span></code>.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="wallet-provider-entity-configuration-jwt-payload">
<h4>Wallet Provider Entity Configuration JWT Payload<a class="headerlink" href="#wallet-provider-entity-configuration-jwt-payload" title="Link to this heading">¶</a></h4>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Key</strong></p></th>
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iss</span></code></p></td>
<td><p>REQUIRED. Public URL of the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sub</span></code></p></td>
<td><p>REQUIRED. Public URL of the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iat</span></code></p></td>
<td><p>REQUIRED. Issuance datetime in Unix Timestamp format.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exp</span></code></p></td>
<td><p>REQUIRED. Expiration datetime in Unix Timestamp format.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">authority_hints</span></code></p></td>
<td><p>REQUIRED. Array of URLs (String) containing the list of URLs of the immediate superior Entities, such as the Trust Anchor or an Intermediate, that MAY issue an Entity Statement related to the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">jwks</span></code></p></td>
<td><p>REQUIRED. A JSON Web Key Set (JWKS) representing the public part of the Wallet Provider's Federation Entity signing keys. The corresponding private key is used by the Entity to sign the Entity Configuration about itself.</p></td>
<td><p><span class="target" id="index-1"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7517.html"><strong>RFC 7517</strong></a>, <a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">metadata</span></code></p></td>
<td><p>REQUIRED.  JSON object that represents the Entity's Types and the metadata for those Entity Types. Each member name of the JSON object is an Entity Type Identifier, and each value MUST be a JSON object containing metadata parameters according to the metadata schema of the Entity Type. It MUST contains the <code class="docutils literal notranslate"><span class="pre">wallet_provider</span></code> and OPTIONALLY the <code class="docutils literal notranslate"><span class="pre">federation_entity</span></code> metadata.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="wallet-provider-metadata">
<h4>wallet_provider metadata<a class="headerlink" href="#wallet-provider-metadata" title="Link to this heading">¶</a></h4>
<p>The metadata JSON Object whose key is <code class="docutils literal notranslate"><span class="pre">wallet_provider</span></code> contains the following parameters. The public keys found in this object are exclusively used for signing and/or encryption operations required to this Entity when acting as a Wallet Provider (e.g., sign the Wallet Attestations to the Wallet Instance).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Key</strong></p></th>
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">jwks</span></code></p></td>
<td><p>CONDITIONAL. JSON Web Key Set document, passed by value, containing the Entity's keys for that Entity Type. It MUST be present if <code class="docutils literal notranslate"><span class="pre">jwks_uri</span></code> and <code class="docutils literal notranslate"><span class="pre">signed_jwks_uri</span></code> are absent.</p></td>
<td><p><span class="target" id="index-2"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7517.html"><strong>RFC 7517</strong></a>, <a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">jwks_uri</span></code></p></td>
<td><p>CONDITIONAL. URL referencing a JWK Set document containing the Wallet Provider's keys for that Entity Type. This URL MUST use the https scheme. It MUST be present if <code class="docutils literal notranslate"><span class="pre">jwks</span></code> and <code class="docutils literal notranslate"><span class="pre">signed_jwks_uri</span></code> are absent.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">signed_jwks_uri</span></code></p></td>
<td><p>CONDITIONAL. URL referencing a signed JWT having the Entity's JWK Set document for that Entity Type as its payload. This URL MUST use the https scheme. The JWT MUST be signed using a Federation Entity Key. A successful response from the URL MUST use the HTTP status code 200 with the Content Type <code class="docutils literal notranslate"><span class="pre">application/jwk-set+jwt</span></code>. It MUST be present if <code class="docutils literal notranslate"><span class="pre">jwks</span></code> and <code class="docutils literal notranslate"><span class="pre">jwks_uri</span></code> are absent.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">aal_values_supported</span></code></p></td>
<td><p>OPTIONAL. List of supported values for the certifiable security context. These values specify the security level  of the app, according to the levels: low, medium, or high. Authenticator Assurance Level values supported.</p></td>
<td><p>This specification.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="federation-entity-metadata">
<h4>federation_entity metadata<a class="headerlink" href="#federation-entity-metadata" title="Link to this heading">¶</a></h4>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Key</strong></p></th>
<th class="head"><p><strong>Value</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">organization_name</span></code></p></td>
<td><p>OPTIONAL.  A human-readable name representing the organization owning the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">homepage_uri</span></code></p></td>
<td><p>OPTIONAL. URL of a Web page for the organization owning the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tos_uri</span></code></p></td>
<td><p>OPTIONAL. URL that contains the Wallet Provider's terms of service.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">policy_uri</span></code></p></td>
<td><p>OPTIONAL. URL of the documentation of conditions and policies relevant to the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">logo_uri</span></code></p></td>
<td><p>OPTIONAL. String. A URL that points to the logo of the Wallet Provider. The file containing the logo SHOULD be published in a format that can be viewed via the web.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a>.</p></td>
</tr>
</tbody>
</table>
<p>Below is a non-normative example of the Entity Configuration for a Wallet Provider.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;ES256&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;kid&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;5t5YYpBhN-EgIEEI5iUzr6r0MR02LnVQ0OmekmNKcjY&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s2">&quot;typ&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;entity-statement+jwt&quot;</span>
<span class="p">}</span>
<span class="p">.</span>
<span class="p">{</span>
<span class="s2">&quot;iss&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://wallet-provider.example.org&quot;</span><span class="p">,</span>
<span class="s2">&quot;sub&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://wallet-provider.example.org&quot;</span><span class="p">,</span>
<span class="s2">&quot;jwks&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="s2">&quot;keys&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="s2">&quot;crv&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;EC&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;qrJrj3Af_B57sbOIRrcBM7br7wOc8ynj7lHFPTeffUk&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;y&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;1H0cWDyGgvU8w-kPKU_xycOCUNT2o0bwslIQtnPU6iM&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;kid&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;5t5YYpBhN-EgIEEI5iUzr6r0MR02LnVQ0OmekmNKcjY&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">},</span>
<span class="s2">&quot;metadata&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="s2">&quot;wallet_provider&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;jwks&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="s2">&quot;keys&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="s2">&quot;crv&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;EC&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;BxYsu3QvYmOz1fl1l5hGyPWlpvgTzz3AY3j3K_9zGPs&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;y&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;ob34Wmfah_ScQXaYMJWoBkZSwO-kQ0VTgMk4VZfu48w&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="s2">&quot;kid&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;749b495837819c00cfee1749b495837819c00cfee1&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="s2">&quot;aal_values_supported&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="s2">&quot;https://wallet-provider.example.org/LoA/basic&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;https://wallet-provider.example.org/LoA/medium&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="s2">&quot;https://wallet-provider.example.org/LoA/high&quot;</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="s2">&quot;federation_entity&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s2">&quot;organization_name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;IT-Wallet Provider&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;homepage_uri&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://wallet-provider.example.org&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;policy_uri&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://wallet-provider.example.org/privacy_policy&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;tos_uri&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://wallet-provider.example.org/info_policy&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;logo_uri&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;https://wallet-provider.example.org/logo.svg&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">},</span>
<span class="s2">&quot;authority_hints&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">  </span><span class="s2">&quot;https://registry.eudi-wallet.example.it&quot;</span>
<span class="p">]</span>
<span class="s2">&quot;iat&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1687171759</span><span class="p">,</span>
<span class="s2">&quot;exp&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1709290159</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="nonce-endpoint">
<h3>Nonce Endpoint<a class="headerlink" href="#nonce-endpoint" title="Link to this heading">¶</a></h3>
<p>This is a RESTful API endpoint that allows the Wallet Instance to request a cryptographic nonce from the Wallet Provider. The nonce serves as an unpredictable, single-use challenge to ensure freshness and prevent replay attacks.</p>
<p>See <a class="reference internal" href="mobile-application-instance.html#mobile-application-nonce-request"><span class="std std-ref">Mobile Application Nonce Request</span></a> and <a class="reference internal" href="mobile-application-instance.html#mobile-application-nonce-response"><span class="std std-ref">Mobile Application Nonce Response</span></a> for details on the Nonce Request and Nonce Response.</p>
</section>
<section id="wallet-instance-management-endpoint">
<h3>Wallet Instance Management Endpoint<a class="headerlink" href="#wallet-instance-management-endpoint" title="Link to this heading">¶</a></h3>
<p>This is a RESTful API endpoint provided by the Wallet Provider that enables Wallet Instance management, including registration, status retrieval, revocation upon request (e.g., by the User), and deletion.
The following sections describe the registration, status retrieval and revocation requests, along with their corresponding responses, handled by this endpoint, which are required for core <a class="reference internal" href="#wallet-instance-functionalities"><span class="std std-ref">Wallet Instance Functionalities</span></a>.</p>
<section id="wallet-instance-registration-request">
<h4>Wallet Instance Registration Request<a class="headerlink" href="#wallet-instance-registration-request" title="Link to this heading">¶</a></h4>
<p>To register a Wallet Instance, the request to the Wallet Provider MUST use the HTTP POST method with <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> set to <cite>application/json</cite>. The request body MUST contain the claims described in <a class="reference internal" href="mobile-application-instance.html#mobile-application-instance-initialization-request"><span class="std std-ref">Mobile Application Instance Initialization Request</span></a>.</p>
</section>
<section id="wallet-instance-registration-response">
<h4>Wallet Instance Registration Response<a class="headerlink" href="#wallet-instance-registration-response" title="Link to this heading">¶</a></h4>
<p>If a Wallet Instance Registration Request is successfully validated, the Wallet Provider provides an HTTP Response with status code 204 (No Content). For detatails see <a class="reference internal" href="mobile-application-instance.html#mobile-application-instance-initialization-response"><span class="std std-ref">Mobile Application Instance Initialization Response</span></a>.</p>
</section>
<section id="wallet-instance-retrieval-request">
<h4>Wallet Instance Retrieval Request<a class="headerlink" href="#wallet-instance-retrieval-request" title="Link to this heading">¶</a></h4>
<p>To retrieve all Wallet Instances associated with a User, a request MUST be sent using the HTTP GET method to the Wallet Provider.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For retrieving a specific Wallet Instance, the request MUST include the Wallet Instance ID as a path parameter.</p>
</div>
</section>
<section id="wallet-instance-retrieval-response">
<h4>Wallet Instance Retrieval Response<a class="headerlink" href="#wallet-instance-retrieval-response" title="Link to this heading">¶</a></h4>
<p>If a Wallet Instance Retrieval Request is successfully processed, the Wallet Provider MUST return an HTTP Response with a 200 (OK) status code.
The response body MUST be in JSON format and include the relevant Wallet Instance information, such as its unique ID, status, and issuance date.
When retrieving all Wallet Instances, the response MUST return an array containing the details of all associated instances.</p>
<p>If any errors occur during the retrieval process, an error response MUST be returned. Refer to <a class="reference internal" href="#error-handling-for-wallet-instance-management"><span class="std std-ref">Error Handling for Wallet Instance Management</span></a> for details on error codes and descriptions.</p>
<p>Below is a non-normative example of an error response:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">403</span> <span class="ne">Forbidden</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
<span class="na">Cache-Control</span><span class="o">:</span> <span class="l">no-store</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;forbidden&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;User is not authorized to retrieve Wallet Instances.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="id61">
<h4>Wallet Instance Revocation Request<a class="headerlink" href="#id61" title="Link to this heading">¶</a></h4>
<p>To revoke an active Wallet Instance, a revocation request MUST be sent using the HTTP PATCH method with Content-Type set to <code class="docutils literal notranslate"><span class="pre">application/json</span></code>. The request body MUST contain a <code class="docutils literal notranslate"><span class="pre">status</span></code> parameter set to <code class="docutils literal notranslate"><span class="pre">REVOKED</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While PATCH is the recommended method, the revocation request MAY also be sent using the POST method, depending on implementation preferences.</p>
</div>
</section>
<section id="id62">
<h4>Wallet Instance Revocation Response<a class="headerlink" href="#id62" title="Link to this heading">¶</a></h4>
<p>If a Wallet Instance Revocation Request is successfully processed, the Wallet Provider provides an HTTP Response with a 204 (No Content) status code.</p>
<p>If any errors occur during the Wallet Instance Revocation, an error response MUST be returned. Refer to <a class="reference internal" href="#error-handling-for-wallet-instance-management"><span class="std std-ref">Error Handling for Wallet Instance Management</span></a> for details on error codes and descriptions.</p>
<p>Below is a non-normative example of an error response:</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">400</span> <span class="ne">Bad Request</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/json</span>
<span class="na">Cache-Control</span><span class="o">:</span> <span class="l">no-store</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bad_request&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;error_description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;The request is missing status parameter.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="error-handling-for-wallet-instance-management">
<h4>Error Handling for Wallet Instance Management<a class="headerlink" href="#error-handling-for-wallet-instance-management" title="Link to this heading">¶</a></h4>
<p>To ensure robustness and security, the Wallet Provider MUST handle errors consistently across all Wallet Instance Management requests, including Registration, Retrieval, and Revocation.</p>
<p>In case of an error, the Wallet Provider MUST return an error response as defined in <span class="target" id="index-3"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7231.html"><strong>RFC 7231</strong></a>, with additional details available in <span class="target" id="index-4"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7807.html"><strong>RFC 7807</strong></a>. The response MUST use the Content-Type set to <code class="docutils literal notranslate"><span class="pre">application/json</span></code> and MUST include the following parameters:</p>
<ul class="simple">
<li><p><em>error</em>. The error code.</p></li>
<li><p><em>error_description</em>. Text in human-readable form providing further details to clarify the nature of the error encountered.</p></li>
</ul>
<p>The following sections categorize errors into <strong>common errors</strong>, which apply to all requests, and <strong>request-specific errors</strong>, which are relevant to particular operations.</p>
<section id="common-error-responses">
<h5>Common Error Responses<a class="headerlink" href="#common-error-responses" title="Link to this heading">¶</a></h5>
<p>The following errors apply to all Wallet Instance Management operations (Registration, Retrieval, and Revocation), and MUST be supported for the error response, unless otherwise specified:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22.2%" />
<col style="width: 22.2%" />
<col style="width: 55.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>HTTP Status Code</strong></p></th>
<th class="head"><p><strong>Error Code</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">400</span> <span class="pre">Bad</span> <span class="pre">Request</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bad_request</span></code></p></td>
<td><p>The request is malformed, missing required parameters, or includes invalid and unknown parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">422</span> <span class="pre">Unprocessable</span> <span class="pre">Content</span></code> [OPTIONAL]</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">validation_error</span></code></p></td>
<td><p>The request does not adhere to the required format.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">500</span> <span class="pre">Internal</span> <span class="pre">Server</span> <span class="pre">Error</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">server_error</span></code></p></td>
<td><p>An internal error occurred while processing the request.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">503</span> <span class="pre">Service</span> <span class="pre">Unavailable</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">temporarily_unavailable</span></code></p></td>
<td><p>The service is unavailable. Please try again later.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="request-specific-error-responses">
<h5>Request-Specific Error Responses<a class="headerlink" href="#request-specific-error-responses" title="Link to this heading">¶</a></h5>
<p>The errors in <a class="reference internal" href="mobile-application-instance.html#mobile-application-instance-initialization-error-response"><span class="std std-ref">Mobile Application Instance Initialization Error Response</span></a> MUST be supported for error responses related to <strong>Wallet Instance Registration</strong>.</p>
<p>The following errors MUST be supported for error responses related to <strong>Wallet Instance Retrieval</strong>:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22.2%" />
<col style="width: 22.2%" />
<col style="width: 55.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>HTTP Status Code</strong></p></th>
<th class="head"><p><strong>Error Code</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">403</span> <span class="pre">Forbidden</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">forbidden</span></code></p></td>
<td><p>The user does not have permission to retrieve this Wallet Instance.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">401</span> <span class="pre">Unauthorized</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">unauthorized</span></code></p></td>
<td><p>The request lacks valid authentication credentials.</p></td>
</tr>
</tbody>
</table>
<p>The following errors MUST be supported for error responses related to <strong>Wallet Instance Revocation</strong>:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 22.2%" />
<col style="width: 22.2%" />
<col style="width: 55.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>HTTP Status Code</strong></p></th>
<th class="head"><p><strong>Error Code</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">403</span> <span class="pre">Forbidden</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">invalid_request</span></code></p></td>
<td><p>The user does not have permission to revoke this Wallet Instance.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">401</span> <span class="pre">Unauthorized</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">unauthorized</span></code></p></td>
<td><p>The request cannot be authenticated or authorized.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="wallet-attestation-issuance-endpoint">
<h3>Wallet Attestation Issuance Endpoint<a class="headerlink" href="#wallet-attestation-issuance-endpoint" title="Link to this heading">¶</a></h3>
<p>This is a RESTful API endpoint provided by the Wallet Provider that enables the Wallet Instance to obtain a Wallet Attestation, by sending a Wallet Attestation Issuance Request.</p>
<section id="wallet-attestation-issuance-request">
<h4>Wallet Attestation Issuance Request<a class="headerlink" href="#wallet-attestation-issuance-request" title="Link to this heading">¶</a></h4>
<p>Further details on the Wallet Attestation Issuance Request are provided in the <a class="reference internal" href="mobile-application-instance.html#mobile-application-key-binding-request"><span class="std std-ref">Mobile Application Key Binding Request</span></a> section.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">typ</span></code> header of the Integrity Request JWT assumes the value <code class="docutils literal notranslate"><span class="pre">wp-war+jwt</span></code>.</p>
</section>
<section id="wallet-attestation-issuance-response">
<span id="id63"></span><h4>Wallet Attestation Issuance Response<a class="headerlink" href="#wallet-attestation-issuance-response" title="Link to this heading">¶</a></h4>
<p>If the Wallet Attestation Issuance Request is successfully validated, the Wallet Provider returns an HTTP response with a status code of <code class="docutils literal notranslate"><span class="pre">200</span> <span class="pre">OK</span></code> and Content-Type <code class="docutils literal notranslate"><span class="pre">application/json</span></code>. The returned JSON Object MUST possess the <code class="docutils literal notranslate"><span class="pre">wallet_attestations</span></code> parameter whose value is an array of JSON Objects (see <a class="reference internal" href="#wallet-attestation-issuance"><span class="std std-ref">Wallet Attestation Issuance</span></a>) containing the Wallet Attestations in JWT, SD-JWT and mdoc format signed by the Wallet Provider. The JWT formatted Wallet Attestation is to be used for the Issuance phase, as an OAuth Client Attestation, and will be sent to the Credential Issuer as discussed in <a class="reference internal" href="pid-eaa-issuance.html#pid-eaa-issuance-rst"><span class="std std-ref">PID/(Q)EAA Issuance</span></a>. The SD-JWT and mdoc formatted Wallet Attestation will instead be used during presentation respectively in the remote (<span class="xref std std-ref">remote_flow.rst</span>) and proximity (<span class="xref std std-ref">proximity_flow_sec_main</span>) flows.</p>
<p>The JSON Object returned in the response has the following claim:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>wallet_attestations</strong></p></td>
<td><p>REQUIRED. Contains an array of one or more issued Wallet Attestation. The elements of the array MUST be JSON Objects. At least two JSON Objects MUST be present.</p></td>
<td><p>This specification.</p></td>
</tr>
</tbody>
</table>
<p>Each JSON Object contained in the <code class="docutils literal notranslate"><span class="pre">wallet_attestations</span></code> array MUST have the following form:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>format</strong></p></td>
<td><p>A string identifying the Data Model used to create and represent the Wallet Attestation. It MUST be either <code class="docutils literal notranslate"><span class="pre">jwt</span></code>, <code class="docutils literal notranslate"><span class="pre">dc+sd-jwt</span></code> or <code class="docutils literal notranslate"><span class="pre">mso_mdoc</span></code> depending on the credential format.</p></td>
<td><p>This specification.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>wallet_attestation</strong></p></td>
<td><p>A string representing the Wallet Attestation. If</p>
<ul class="simple">
<li><p>the Wallet Attestation is in JWT format, then the claim's value MUST be a string that is a JWT.</p></li>
<li><p>the Wallet Attestation is in SD-JWT format, then the claim's value MUST be a string that is an SD-JWT VC.</p></li>
<li><p>the Wallet Attestation is in mdoc format, then the claim's value is the base64url-encoded representation of the CBOR-encoded IssuerSigned structure, as defined in [ISO.18013-5]. This structure MUST contain all Namespaces and IssuerSignedItems that are included in the MobileSecurityObject.</p></li>
</ul>
</td>
<td><p>This specification.</p></td>
</tr>
</tbody>
</table>
<p>If any errors occur during the process, an error response is returned. Further details on the error response are provided in the <a class="reference internal" href="mobile-application-instance.html#mobile-application-key-binding-error-response"><span class="std std-ref">Mobile Application Key Binding Error Response</span></a> section.</p>
<section id="wallet-attestation-jwt">
<h5>Wallet Attestation JWT<a class="headerlink" href="#wallet-attestation-jwt" title="Link to this heading">¶</a></h5>
<p>The JOSE header of the Wallet Attestation JWT contains the following parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>JOSE header</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>alg</strong></p></td>
<td><p>REQUIRED. A digital signature algorithm identifier such as per IANA &quot;JSON Web Signature and Encryption Algorithms&quot; registry. It MUST be one of the supported algorithms listed in the Section <a class="reference internal" href="algorithms.html#cryptographic-algorithms"><span class="std std-ref">Cryptographic Algorithms</span></a> and MUST NOT be set to <code class="docutils literal notranslate"><span class="pre">none</span></code> or any symmetric algorithm (MAC) identifier.</p></td>
<td><p><span class="target" id="index-5"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7516.html#section-4.1.1"><strong>RFC 7516#section-4.1.1</strong></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>kid</strong></p></td>
<td><p>REQUIRED. Unique identifier of the public key associated to the private key the Wallet Provider used to sign the Wallet Attestation.</p></td>
<td><p><span class="target" id="index-6"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7638.html#section_3"><strong>RFC 7638#section_3</strong></a>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>typ</strong></p></td>
<td><p>REQUIRED. It MUST be set to <code class="docutils literal notranslate"><span class="pre">oauth-client-attestation+jwt</span></code></p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid4vc-high-assurance-interoperability-profile-sd-jwt-vc-1_0.html">OPENID4VC-HAIP</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>trust_chain</strong></p></td>
<td><p>REQUIRED. Sequence of Entity Statements that composes the Trust Chain related to the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a> Section 4.3 <em>Trust Chain Header Parameter</em>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>x5c</strong></p></td>
<td><p>OPTIONAL. Contains the X.509 public key certificate or certificate chain (<span class="target" id="index-7"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc5280.html"><strong>RFC 5280</strong></a>) corresponding to the key used to digitally sign the JWT.</p></td>
<td><p><span class="target" id="index-8"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7515.html"><strong>RFC 7515</strong></a> Section 4.1.8 and <a class="reference external" href="https://datatracker.ietf.org/doc/draft-ietf-oauth-sd-jwt-vc/06/">SD-JWT-VC</a> Section 3.5.</p></td>
</tr>
</tbody>
</table>
<p>The body of the Wallet Attestation JWT contains the following claims:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Claim</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>iss</strong></p></td>
<td><p>REQUIRED. Identifier of the Wallet Provider.</p></td>
<td><p><span class="target" id="index-9"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9126.html"><strong>RFC 9126</strong></a> and <span class="target" id="index-10"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7519.html"><strong>RFC 7519</strong></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>exp</strong></p></td>
<td><p>REQUIRED. UNIX Timestamp with the expiry time of the JWT.</p></td>
<td><p><span class="target" id="index-11"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9126.html"><strong>RFC 9126</strong></a> and <span class="target" id="index-12"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7519.html"><strong>RFC 7519</strong></a>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>iat</strong></p></td>
<td><p>REQUIRED. UNIX Timestamp with the time of JWT issuance.</p></td>
<td><p><span class="target" id="index-13"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9126.html"><strong>RFC 9126</strong></a> and <span class="target" id="index-14"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7519.html"><strong>RFC 7519</strong></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>cnf</strong></p></td>
<td><p>REQUIRED. JSON object, containing the public part of an asymmetric key pair owned by the Wallet Instance.</p></td>
<td><p><span class="target" id="index-15"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7800.html"><strong>RFC 7800</strong></a>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>wallet_link</strong></p></td>
<td><p>OPTIONAL. String containing a URL to get further information about the Wallet and the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0-15.html">OpenID4VCI</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>wallet_name</strong></p></td>
<td><p>OPTIONAL. String containing a human-readable name of the Wallet.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0-15.html">OpenID4VCI</a>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>sub</strong></p></td>
<td><p>REQUIRED. Identifier of the Wallet Instance which is the thumbprint of the Wallet Attestation JWK.</p></td>
<td><p><span class="target" id="index-16"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9126.html"><strong>RFC 9126</strong></a> and <span class="target" id="index-17"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7519.html"><strong>RFC 7519</strong></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>aal</strong></p></td>
<td><p>REQUIRED. JSON String asserting the authentication level of the Wallet and the key as asserted in the cnf claim.</p></td>
<td><p>This specification.</p></td>
</tr>
</tbody>
</table>
<p>Below is a non-normative example of the SD-JWT Wallet Attestation without encoding and signature applied:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;alg&quot;</span><span class="p">:</span> <span class="s2">&quot;ES256&quot;</span><span class="p">,</span>
  <span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;5t5YYpBhN-EgIEEI5iUzr6r0MR02LnVQ0OmekmNKcjY&quot;</span><span class="p">,</span>
  <span class="s2">&quot;trust_chain&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;eyJhbGciOiJFUz...6S0A&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eyJhbGciOiJFUz...jJLA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eyJhbGciOiJFUz...H9gw&quot;</span><span class="p">,</span>
  <span class="p">],</span>
  <span class="s2">&quot;typ&quot;</span><span class="p">:</span> <span class="s2">&quot;jwt&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="o">.</span>
<span class="p">{</span>
  <span class="s2">&quot;iss&quot;</span><span class="p">:</span> <span class="s2">&quot;https://wallet-provider.example.org&quot;</span><span class="p">,</span>
  <span class="s2">&quot;cnf&quot;</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s2">&quot;jwk&quot;</span><span class="p">:</span>
    <span class="p">{</span>
      <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
      <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
      <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;4HNptI-xr2pjyRJKGMnz4WmdnQD_uJSq4R95Nj98b44&quot;</span><span class="p">,</span>
      <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;LIZnSB39vFJhYgS3k7jXE4r3-CoGFQwZtPBIRqpNlrg&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;iat&quot;</span><span class="p">:</span> <span class="mi">1687281195</span><span class="p">,</span>
  <span class="s2">&quot;exp&quot;</span><span class="p">:</span> <span class="mi">1687288395</span><span class="p">,</span>
  <span class="s2">&quot;vct&quot;</span><span class="p">:</span> <span class="s2">&quot;wallet.atestation.example/v1.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;sub&quot;</span><span class="p">:</span> <span class="s2">&quot;vbeXJksM45xphtANnCiG6mCyuU4jfGNzopGuKvogg9c&quot;</span><span class="p">,</span>
  <span class="s2">&quot;aal&quot;</span><span class="p">:</span> <span class="s2">&quot;https://trust-list.eu/aal/high&quot;</span><span class="p">,</span>
  <span class="s2">&quot;wallet_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Wallet_v1&quot;</span><span class="p">,</span>
  <span class="s2">&quot;wallet_link&quot;</span><span class="p">:</span> <span class="s2">&quot;https://example.com/wallet/detail_info.html&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="wallet-attestation-sd-jwt">
<h5>Wallet Attestation SD-JWT<a class="headerlink" href="#wallet-attestation-sd-jwt" title="Link to this heading">¶</a></h5>
<p>The JOSE header of the Wallet Attestation SD-JWT MUST contain the following parameters:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>JOSE header</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>alg</strong></p></td>
<td><p>REQUIRED. A digital signature algorithm identifier such as per IANA &quot;JSON Web Signature and Encryption Algorithms&quot; registry. It MUST be one of the supported algorithms listed in <a class="reference internal" href="algorithms.html#cryptographic-algorithms"><span class="std std-ref">Cryptographic Algorithms</span></a> and MUST NOT be set to <code class="docutils literal notranslate"><span class="pre">none</span></code> or any symmetric algorithm (MAC) identifier.</p></td>
<td><p><span class="target" id="index-18"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7516.html#section-4.1.1"><strong>RFC 7516#section-4.1.1</strong></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>kid</strong></p></td>
<td><p>REQUIRED. Unique identifier of the public key associated to the private key the Wallet Provider used to sign the Wallet Attestation.</p></td>
<td><p><span class="target" id="index-19"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7638.html#section_3"><strong>RFC 7638#section_3</strong></a>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>typ</strong></p></td>
<td><p>REQUIRED. It MUST be set to <code class="docutils literal notranslate"><span class="pre">dc+sd-jwt</span></code></p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid4vc-high-assurance-interoperability-profile-sd-jwt-vc-1_0.html">OPENID4VC-HAIP</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>trust_chain</strong></p></td>
<td><p>REQUIRED. Sequence of Entity Statements that composes the Trust Chain related to the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-federation-1_0-41.html">OID-FED</a> Section 4.3 <em>Trust Chain Header Parameter</em>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>x5c</strong></p></td>
<td><p>OPTIONAL. Contains the X.509 public key certificate or certificate chain (<span class="target" id="index-20"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc5280.html"><strong>RFC 5280</strong></a>) corresponding to the key used to digitally sign the JWT.</p></td>
<td><p><span class="target" id="index-21"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7515.html"><strong>RFC 7515</strong></a> Section 4.1.8 and <a class="reference external" href="https://datatracker.ietf.org/doc/draft-ietf-oauth-sd-jwt-vc/06/">SD-JWT-VC</a> Section 3.5.</p></td>
</tr>
</tbody>
</table>
<p>The body of the Wallet Attestation SD-JWT contains the following claims:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Claim</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>iss</strong></p></td>
<td><p>REQUIRED. Identifier of the Wallet Provider.</p></td>
<td><p><span class="target" id="index-22"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9126.html"><strong>RFC 9126</strong></a> and <span class="target" id="index-23"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7519.html"><strong>RFC 7519</strong></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>exp</strong></p></td>
<td><p>REQUIRED. UNIX Timestamp with the expiry time of the JWT.</p></td>
<td><p><span class="target" id="index-24"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9126.html"><strong>RFC 9126</strong></a> and <span class="target" id="index-25"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7519.html"><strong>RFC 7519</strong></a>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>iat</strong></p></td>
<td><p>REQUIRED. UNIX Timestamp with the time of JWT issuance.</p></td>
<td><p><span class="target" id="index-26"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9126.html"><strong>RFC 9126</strong></a> and <span class="target" id="index-27"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7519.html"><strong>RFC 7519</strong></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>cnf</strong></p></td>
<td><p>REQUIRED. JSON object, containing the public part of an asymmetric key pair owned by the Wallet Instance.</p></td>
<td><p><span class="target" id="index-28"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7800.html"><strong>RFC 7800</strong></a>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>vct</strong></p></td>
<td><p>REQUIRED. Credential type value MUST be an HTTPS URL String and it MUST be set to <code class="docutils literal notranslate"><span class="pre">wallet.atestation.example/v1.0</span></code>.</p></td>
<td><p>Section 3.2.2.2 <a class="reference external" href="https://datatracker.ietf.org/doc/draft-ietf-oauth-sd-jwt-vc/06/">SD-JWT-VC</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>_sd</strong></p></td>
<td><p>REQUIRED. String containing the hash algorithm used by the Wallet Provider to generate the digests.</p></td>
<td><p><a class="reference external" href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-14">SD-JWT</a>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>sd_alg</strong></p></td>
<td><p>REQUIRED. JSON array containing a list of the signing algorithms (alg values) supported.</p></td>
<td><p><a class="reference external" href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-selective-disclosure-jwt-14">SD-JWT</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>sub</strong></p></td>
<td><p>REQUIRED. Identifier of the Wallet Instance which is the thumbprint of the Wallet Attestation JWK.</p></td>
<td><p><span class="target" id="index-29"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9126.html"><strong>RFC 9126</strong></a> and <span class="target" id="index-30"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7519.html"><strong>RFC 7519</strong></a>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>aal</strong></p></td>
<td><p>REQUIRED. JSON String asserting the authentication level of the Wallet and the key as asserted in the cnf claim.</p></td>
<td><p>This specification.</p></td>
</tr>
</tbody>
</table>
<p>The following disclosures MAY be present:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Disclosure</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>wallet_link</strong></p></td>
<td><p>OPTIONAL. String containing a URL to get further information about the Wallet and the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0-15.html">OpenID4VCI</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>wallet_name</strong></p></td>
<td><p>OPTIONAL. String containing a human-readable name of the Wallet.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0-15.html">OpenID4VCI</a>.</p></td>
</tr>
</tbody>
</table>
<p>Below are described examples of values for the disclosures:</p>
<p><strong>Claim</strong> <code class="docutils literal notranslate"><span class="pre">wallet_link</span></code>:</p>
<ul class="simple">
<li><p>SHA-256 Hash: <code class="docutils literal notranslate"><span class="pre">cD9/XC7t7QVHvmSiE1dGW0WYr0jcqm8n0GA6MGitaik=</span></code></p></li>
<li><p>Disclosure: <code class="docutils literal notranslate"><span class="pre">WyIyR0xDNDJzS1F2ZUNmR2ZyeU5STjl3IiwgIndhbGxldF9saW5rIiwgImh0dHBzOi8vZXhhbXBsZS5jb20vd2FsbGV0L2RldGFpbF9pbmZvLmh0bWwiXQ==</span></code></p></li>
<li><p>Contents: <code class="docutils literal notranslate"><span class="pre">[&quot;2GLC42sKQveCfGfryNRN9w&quot;,</span> <span class="pre">&quot;wallet_link&quot;,</span> <span class="pre">&quot;https://example.com/wallet/detail_info.html&quot;]</span></code></p></li>
</ul>
<p><strong>Claim</strong> <code class="docutils literal notranslate"><span class="pre">wallet_name</span></code>:</p>
<ul class="simple">
<li><p>SHA-256 Hash: <code class="docutils literal notranslate"><span class="pre">iQQhzf6+saYCzHH92N1QyJisKsZbApbTrJ1amHgLoOk=</span></code></p></li>
<li><p>Disclosure:n``WyIyR0xDNDJzS1F2ZUNmR2ZyeU5STjl3IiwgIndhbGxldF9uYW1lIiwgIldhbGxldF9Ib2JiaXRvbl92MSJd``</p></li>
<li><p>Contents: <code class="docutils literal notranslate"><span class="pre">[&quot;2GLC42sKQveCfGfryNRN9w&quot;,</span> <span class="pre">&quot;wallet_name&quot;,</span> <span class="pre">&quot;Wallet_v1&quot;]</span></code></p></li>
</ul>
<p>Below is a non-normative example of the SD-JWT Wallet Attestation without encoding and signature applied:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;alg&quot;</span><span class="p">:</span> <span class="s2">&quot;ES256&quot;</span><span class="p">,</span>
  <span class="s2">&quot;kid&quot;</span><span class="p">:</span> <span class="s2">&quot;5t5YYpBhN-EgIEEI5iUzr6r0MR02LnVQ0OmekmNKcjY&quot;</span><span class="p">,</span>
  <span class="s2">&quot;trust_chain&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;eyJhbGciOiJFUz...6S0A&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eyJhbGciOiJFUz...jJLA&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eyJhbGciOiJFUz...H9gw&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;typ&quot;</span><span class="p">:</span> <span class="s2">&quot;dc+sd-jwt&quot;</span>
<span class="p">}</span>
<span class="o">.</span>
<span class="p">{</span>
  <span class="s2">&quot;iss&quot;</span><span class="p">:</span> <span class="s2">&quot;https://wallet-provider.example.org&quot;</span><span class="p">,</span>
  <span class="s2">&quot;cnf&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;jwk&quot;</span><span class="p">:</span>
    <span class="p">{</span>
      <span class="s2">&quot;crv&quot;</span><span class="p">:</span> <span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
      <span class="s2">&quot;kty&quot;</span><span class="p">:</span> <span class="s2">&quot;EC&quot;</span><span class="p">,</span>
      <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="s2">&quot;4HNptI-xr2pjyRJKGMnz4WmdnQD_uJSq4R95Nj98b44&quot;</span><span class="p">,</span>
      <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="s2">&quot;LIZnSB39vFJhYgS3k7jXE4r3-CoGFQwZtPBIRqpNlrg&quot;</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;_sd&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;cD9/XC7t7QVHvmSiE1dGW0WYr0jcqm8n0GA6MGitaik=&quot;</span><span class="p">,</span> <span class="s2">&quot;iQQhzf6+saYCzHH92N1QyJisKsZbApbTrJ1amHgLoOk=&quot;</span><span class="p">],</span>
  <span class="s2">&quot;_sd_alg&quot;</span><span class="p">:</span> <span class="s2">&quot;sha-256&quot;</span><span class="p">,</span>
  <span class="s2">&quot;iat&quot;</span><span class="p">:</span> <span class="mi">1687281195</span><span class="p">,</span>
  <span class="s2">&quot;exp&quot;</span><span class="p">:</span> <span class="mi">1687288395</span><span class="p">,</span>
  <span class="s2">&quot;vct&quot;</span><span class="p">:</span> <span class="s2">&quot;https://wallet.attestation.example/v1.0&quot;</span><span class="p">,</span>
  <span class="s2">&quot;sub&quot;</span><span class="p">:</span> <span class="s2">&quot;vbeXJksM45xphtANnCiG6mCyuU4jfGNzopGuKvogg9c&quot;</span><span class="p">,</span>
  <span class="s2">&quot;aal&quot;</span><span class="p">:</span> <span class="s2">&quot;https://trust-framework.example.it/aal/high&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="wallet-attestation-mdoc">
<h5>Wallet Attestation mdoc<a class="headerlink" href="#wallet-attestation-mdoc" title="Link to this heading">¶</a></h5>
<p>This description further specializes the guidelines given in <cite>MDOC-CBOR Credential Format</cite> to represent the Wallet Attestation in mdoc format. The latter MUST:</p>
<ul class="simple">
<li><p>have the domestic namespace <code class="docutils literal notranslate"><span class="pre">org.iso.18013.5.1.it</span></code>;</p></li>
<li><p>have <strong>docType</strong> set to <code class="docutils literal notranslate"><span class="pre">org.iso.18013.5.1.it.WalletAttestation</span></code>; and</p></li>
<li><p>have <strong>issuerAuth</strong> as described in <a class="reference internal" href="pid-eaa-data-model.html#mobile-security-object"><span class="std std-ref">Mobile Security Object</span></a>.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">nameSpaces</span></code> for the domestic nameSpace Json Objects are defined as follows:</p>
<table class="docutils align-default" id="id70">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">org.iso.18013.5.1.it</span><a class="headerlink" href="#id70" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 60.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>elementIdentifier</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
<th class="head"><p><strong>Reference</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>sub</strong></p></td>
<td><p>REQUIRED. Identifier of the Wallet Instance which is the thumbprint of the Wallet Attestation COSE Key.</p></td>
<td><p><span class="target" id="index-31"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9126.html"><strong>RFC 9126</strong></a> and <span class="target" id="index-32"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc7519.html"><strong>RFC 7519</strong></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>aal</strong></p></td>
<td><p>JSON String asserting the authentication level of the Wallet Instance in relation to the COSE Key contained in the <code class="docutils literal notranslate"><span class="pre">IssuerAuth.deviceKeyInfo.deviceKey</span></code> claim of the <strong>issuerAuth</strong> Object.</p></td>
<td><p><span class="target" id="index-33"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9679.html"><strong>RFC 9679</strong></a>.</p></td>
</tr>
<tr class="row-even"><td><p><strong>wallet_link</strong></p></td>
<td><p>JSON String containing a URL to get further information about the Wallet and the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0-15.html">OpenID4VCI</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>wallet_name</strong></p></td>
<td><p>JSON String, it MUST be the Identifier of the Wallet Provider.</p></td>
<td><p><a class="reference external" href="https://openid.net/specs/openid-4-verifiable-credential-issuance-1_0-15.html">OpenID4VCI</a>.</p></td>
</tr>
</tbody>
</table>
<p>Below is a non-normative example of the mdoc Wallet Attestation in CBOR diagnostic notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;docType&quot;</span><span class="p">:</span> <span class="s2">&quot;org.iso.18013.5.1.it.WalletAttestation&quot;</span><span class="p">,</span>
  <span class="s2">&quot;issuerSigned&quot;</span><span class="p">:{</span>
    <span class="s2">&quot;nameSpaces&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;org.iso.18013.5.1.it&quot;</span><span class="p">:[</span>
        <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
        <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;960CB15A…E902807AA95&#39;</span><span class="p">,</span>
        <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;wallet_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span> <span class="s2">&quot;Wallet_v1&quot;</span>
        <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
        <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span>
        <span class="p">{</span>
        <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;9D3774BD59…A4F76A&#39;</span><span class="p">,</span>
        <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;wallet_link&quot;</span><span class="p">,</span>
        <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span><span class="s2">&quot;https://example.com/wallet/detail_info.html&quot;</span>
        <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
        <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span> <span class="p">{</span>
        <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;AE84834F3…A3E4FCCE&#39;</span><span class="p">,</span>
        <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;sub&quot;</span><span class="p">,</span>
        <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span><span class="s2">&quot;vbeXJksM45xphtANnCiG6mCyuU4jfGNzopGuKvogg9c&quot;</span>
        <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">),</span>
        <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span>
        <span class="p">{</span>
        <span class="s2">&quot;digestID&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="s2">&quot;random&quot;</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;9D3774BD59…A4F76A&#39;</span><span class="p">,</span>
        <span class="s2">&quot;elementIdentifier&quot;</span><span class="p">:</span> <span class="s2">&quot;aal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;elementValue&quot;</span><span class="p">:</span><span class="s2">&quot;https://trust-list.eu/aal/high&quot;</span>
        <span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">)</span>
      <span class="p">]</span>
<span class="p">},</span>
  <span class="s2">&quot;issuerAuth&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="o">&lt;&lt;</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="o">-</span><span class="mi">7</span><span class="p">}</span> <span class="o">&gt;&gt;</span><span class="p">,</span>
    <span class="p">{</span>
    <span class="mi">33</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;30820215308201BCA003020102021404AD30C…&#39;</span>
    <span class="p">},</span>
    <span class="o">&lt;&lt;</span>
      <span class="mi">24</span><span class="p">(</span><span class="o">&lt;&lt;</span>
        <span class="p">{</span>
          <span class="s2">&quot;docType&quot;</span><span class="p">:</span><span class="s2">&quot;org.iso.18013.5.1.it.WalletAttestation&quot;</span><span class="p">,</span>
          <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;org.iso.18013.5.1.it&quot;</span><span class="p">,</span>
          <span class="s2">&quot;validityInfo&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;signed&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-02-22T06:23:56Z&quot;</span>
            <span class="s2">&quot;validFrom&quot;</span><span class="p">:</span> <span class="s2">&quot;2023-02-22T06:23:56Z&quot;</span><span class="p">,</span>
            <span class="s2">&quot;validUntil&quot;</span><span class="p">:</span> <span class="s2">&quot;2024-02-22T00:00:00Z&quot;</span>
          <span class="p">},</span>
          <span class="s2">&quot;valueDigests&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;org.iso.18013.5.1.it&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="mi">0</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;0F1571A988FCDF2929…&#39;</span><span class="p">,</span>
              <span class="mi">1</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;0CDFE0774A2B596C90…&#39;</span><span class="p">,</span>
              <span class="mi">2</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;E23821492558984395…&#39;</span><span class="p">,</span>
              <span class="mi">3</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;BBC77E6CCE544EDF86…&#39;</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">&quot;deviceKeyInfo&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;deviceKey&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
              <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
              <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;B820963964E5…&#39;</span><span class="p">,</span>
              <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="n">h</span><span class="s1">&#39;0A6DA0AF437E…&#39;</span>
            <span class="p">}</span>
          <span class="p">},</span>
          <span class="s2">&quot;digestAlgorithm&quot;</span><span class="p">:</span> <span class="s2">&quot;SHA-256&quot;</span>
        <span class="p">}</span>
      <span class="o">&gt;&gt;</span><span class="p">)</span>
    <span class="o">&gt;&gt;</span><span class="p">,</span>
    <span class="n">h</span><span class="s1">&#39;1AD0D6A7313EFDC…43DEBF48BF5A580D&#39;</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&lt;</span><span>Page contents</span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&gt;</span><span>Page contents:</span></a></p>
            <div class="page_toc">
                <ul>
<li><a class="reference internal" href="#">Wallet Solution</a><ul>
<li><a class="reference internal" href="#wallet-solution-requirements">Wallet Solution Requirements</a><ul>
<li><a class="reference internal" href="#wallet-attestation-requirements">Wallet Attestation Requirements</a></li>
<li><a class="reference internal" href="#wscd-requirements">WSCD Requirements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wallet-instance">Wallet Instance</a><ul>
<li><a class="reference internal" href="#wallet-instance-lifecycle">Wallet Instance Lifecycle</a><ul>
<li><a class="reference internal" href="#transition-to-installed">Transition to Installed</a></li>
<li><a class="reference internal" href="#transition-to-operational">Transition to Operational</a></li>
<li><a class="reference internal" href="#transition-to-valid">Transition to Valid</a></li>
<li><a class="reference internal" href="#transition-to-uninstalled">Transition to Uninstalled</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wallet-instance-lifecycle-management">Wallet Instance Lifecycle Management</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wallet-instance-functionalities">Wallet Instance Functionalities</a><ul>
<li><a class="reference internal" href="#wallet-instance-initialization-and-registration">Wallet Instance Initialization and Registration</a></li>
<li><a class="reference internal" href="#wallet-attestation-issuance">Wallet Attestation Issuance</a></li>
<li><a class="reference internal" href="#wallet-instance-revocation">Wallet Instance Revocation</a><ul>
<li><a class="reference internal" href="#wallet-instance-revocation-request">Wallet Instance Revocation Request</a></li>
<li><a class="reference internal" href="#wallet-instance-revocation-response">Wallet Instance Revocation Response</a></li>
<li><a class="reference internal" href="#revocation-check-mechanisms">Revocation Check Mechanisms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#user-s-attributes-deletion">User's Attributes Deletion</a></li>
</ul>
</li>
<li><a class="reference internal" href="#wallet-provider-endpoints">Wallet Provider Endpoints</a><ul>
<li><a class="reference internal" href="#federation-endpoint">Federation Endpoint</a><ul>
<li><a class="reference internal" href="#wallet-provider-entity-configuration">Wallet Provider Entity Configuration</a></li>
<li><a class="reference internal" href="#wallet-provider-entity-configuration-jwt-header">Wallet Provider Entity Configuration JWT Header</a></li>
<li><a class="reference internal" href="#wallet-provider-entity-configuration-jwt-payload">Wallet Provider Entity Configuration JWT Payload</a></li>
<li><a class="reference internal" href="#wallet-provider-metadata">wallet_provider metadata</a></li>
<li><a class="reference internal" href="#federation-entity-metadata">federation_entity metadata</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nonce-endpoint">Nonce Endpoint</a></li>
<li><a class="reference internal" href="#wallet-instance-management-endpoint">Wallet Instance Management Endpoint</a><ul>
<li><a class="reference internal" href="#wallet-instance-registration-request">Wallet Instance Registration Request</a></li>
<li><a class="reference internal" href="#wallet-instance-registration-response">Wallet Instance Registration Response</a></li>
<li><a class="reference internal" href="#wallet-instance-retrieval-request">Wallet Instance Retrieval Request</a></li>
<li><a class="reference internal" href="#wallet-instance-retrieval-response">Wallet Instance Retrieval Response</a></li>
<li><a class="reference internal" href="#id61">Wallet Instance Revocation Request</a></li>
<li><a class="reference internal" href="#id62">Wallet Instance Revocation Response</a></li>
<li><a class="reference internal" href="#error-handling-for-wallet-instance-management">Error Handling for Wallet Instance Management</a><ul>
<li><a class="reference internal" href="#common-error-responses">Common Error Responses</a></li>
<li><a class="reference internal" href="#request-specific-error-responses">Request-Specific Error Responses</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#wallet-attestation-issuance-endpoint">Wallet Attestation Issuance Endpoint</a><ul>
<li><a class="reference internal" href="#wallet-attestation-issuance-request">Wallet Attestation Issuance Request</a></li>
<li><a class="reference internal" href="#wallet-attestation-issuance-response">Wallet Attestation Issuance Response</a><ul>
<li><a class="reference internal" href="#wallet-attestation-jwt">Wallet Attestation JWT</a></li>
<li><a class="reference internal" href="#wallet-attestation-sd-jwt">Wallet Attestation SD-JWT</a></li>
<li><a class="reference internal" href="#wallet-attestation-mdoc">Wallet Attestation mdoc</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
        </div>
    

      <div class="clearer"></div>
    </div>
    <div class="button_nav_wrapper">
        <div class="button_nav">
            <div class="left">
                
                <a href="trust.html">
                    <span class="icon">&lt;</span><span>The Infrastructure of Trust</span></a>
                
            </div>

            <div class="right">
                
                    <a href="issuer-solution.html"><span>Issuer Solution</span><span class="icon">&gt;</span></a>
                
            </div>
        </div>
    </div>


    <div class="footer" role="contentinfo">
      Last updated on 06/05/2025.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.5.
    </div>

<p id="theme_credit"></p>
  </body>
</html>