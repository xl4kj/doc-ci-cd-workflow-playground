<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1773px" preserveAspectRatio="none" style="width:1398px;height:1773px;background:#FFFFFF;" version="1.1" viewBox="0 0 1398 1773" width="1398px" zoomAndPan="magnify"><defs/><g><rect fill="#ADD8E6" height="1761.4375" style="stroke:#181818;stroke-width:0.5;" width="467.4092" x="167.1709" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106.5645" x="347.5933" y="18.0669">User's Devices</text><rect fill="#ADD8E6" height="1761.4375" style="stroke:#181818;stroke-width:0.5;" width="458.2202" x="916.8267" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="98.6997" x="1096.5869" y="18.0669">Relying Party</text><g><title>User</title><rect fill="#FFFFFF" height="51.1328" style="stroke:#181818;stroke-width:1;" width="10" x="18.9551" y="91.2969"/></g><g><title>User</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="18.9551" y="920.2891"/></g><g><title>Wallet Instance</title><rect fill="#FFFFFF" height="1071.5859" style="stroke:#181818;stroke-width:1;" width="10" x="227.3218" y="444.7578"/></g><g><title>user-agent</title><rect fill="#FFFFFF" height="332.3281" style="stroke:#181818;stroke-width:1;" width="10" x="580.5654" y="112.4297"/></g><g><title>user-agent</title><rect fill="#FFFFFF" height="214.0625" style="stroke:#181818;stroke-width:1;" width="10" x="580.5654" y="1456.0781"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="244.0625" style="stroke:#181818;stroke-width:1;" width="10" x="972.6948" y="171.5625"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="122.2031" style="stroke:#181818;stroke-width:1;" width="10" x="972.6948" y="642.5547"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="522.6563" style="stroke:#181818;stroke-width:1;" width="10" x="972.6948" y="993.6875"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="972.6948" y="1641.0078"/></g><g><title>status endpoint</title><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1;" width="10" x="1304.2739" y="1560.6094"/></g><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:1.5;" width="210.6118" x="161.1709" y="459.7578"/><rect fill="none" height="132.3359" style="stroke:#000000;stroke-width:1.5;" width="1133.1226" x="161.1709" y="604.2891"/><rect fill="none" height="90.5313" style="stroke:#000000;stroke-width:1.5;" width="883.3921" x="161.1709" y="1373.5469"/><rect fill="none" height="134.7969" style="stroke:#000000;stroke-width:1.5;" width="1219.876" x="161.1709" y="1478.0781"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="1606.8438" width="8" x="19.9551" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="81.2969" y2="1688.1406"/></g><g><title>Wallet Instance</title><rect fill="#000000" fill-opacity="0.00000" height="1606.8438" width="8" x="228.3218" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="232.1709" x2="232.1709" y1="81.2969" y2="1688.1406"/></g><g><title>user-agent</title><rect fill="#000000" fill-opacity="0.00000" height="1606.8438" width="8" x="581.5654" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="585.5508" x2="585.5508" y1="81.2969" y2="1688.1406"/></g><g><title>Relying Party</title><rect fill="#000000" fill-opacity="0.00000" height="1606.8438" width="8" x="973.6948" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="976.8267" x2="976.8267" y1="81.2969" y2="1688.1406"/></g><g><title>status endpoint</title><rect fill="#000000" fill-opacity="0.00000" height="1606.8438" width="8" x="1305.2739" y="81.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1308.501" x2="1308.501" y1="81.2969" y2="1688.1406"/></g><g class="participant participant-head" data-participant="u"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="77.9951">User</text><ellipse cx="23.9551" cy="13.5" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,21.5 L23.9551,48.5 M10.9551,29.5 L36.9551,29.5 M23.9551,48.5 L10.9551,63.5 M23.9551,48.5 L36.9551,63.5" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="u"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="1700.1357">User</text><ellipse cx="23.9551" cy="1711.9375" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,1719.9375 L23.9551,1746.9375 M10.9551,1727.9375 L36.9551,1727.9375 M23.9551,1746.9375 L10.9551,1761.9375 M23.9551,1746.9375 L36.9551,1761.9375" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="w"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.3018" x="171.1709" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.3018" x="178.1709" y="69.9951">Wallet Instance</text></g><g class="participant participant-tail" data-participant="w"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122.3018" x="171.1709" y="1687.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108.3018" x="178.1709" y="1707.1357">Wallet Instance</text></g><g class="participant participant-head" data-participant="ua"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90.0293" x="540.5508" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.0293" x="547.5508" y="69.9951">user-agent</text></g><g class="participant participant-tail" data-participant="ua"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90.0293" x="540.5508" y="1687.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.0293" x="547.5508" y="1707.1357">user-agent</text></g><g class="participant participant-head" data-participant="ve"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.7363" x="920.8267" y="33.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.167" x="931.1113" y="53.6982">Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.7363" x="927.8267" y="69.9951">(OAuth Client)</text></g><g class="participant participant-tail" data-participant="ve"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113.7363" x="920.8267" y="1687.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.167" x="931.1113" y="1707.1357">Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.7363" x="927.8267" y="1723.4326">(OAuth Client)</text></g><g class="participant participant-head" data-participant="se"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123.5459" x="1247.501" y="50"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109.5459" x="1254.501" y="69.9951">status endpoint</text></g><g class="participant participant-tail" data-participant="se"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123.5459" x="1247.501" y="1687.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109.5459" x="1254.501" y="1707.1357">status endpoint</text></g><g><title>User</title><rect fill="#FFFFFF" height="51.1328" style="stroke:#181818;stroke-width:1;" width="10" x="18.9551" y="91.2969"/></g><g><title>User</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="18.9551" y="920.2891"/></g><g><title>Wallet Instance</title><rect fill="#FFFFFF" height="1071.5859" style="stroke:#181818;stroke-width:1;" width="10" x="227.3218" y="444.7578"/></g><g><title>user-agent</title><rect fill="#FFFFFF" height="332.3281" style="stroke:#181818;stroke-width:1;" width="10" x="580.5654" y="112.4297"/></g><g><title>user-agent</title><rect fill="#FFFFFF" height="214.0625" style="stroke:#181818;stroke-width:1;" width="10" x="580.5654" y="1456.0781"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="244.0625" style="stroke:#181818;stroke-width:1;" width="10" x="972.6948" y="171.5625"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="122.2031" style="stroke:#181818;stroke-width:1;" width="10" x="972.6948" y="642.5547"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="522.6563" style="stroke:#181818;stroke-width:1;" width="10" x="972.6948" y="993.6875"/></g><g><title>Relying Party</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1;" width="10" x="972.6948" y="1641.0078"/></g><g><title>status endpoint</title><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1;" width="10" x="1304.2739" y="1560.6094"/></g><g class="message" data-participant-1="u" data-participant-2="ua"><polygon fill="#181818" points="568.5654,108.4297,578.5654,112.4297,568.5654,116.4297,572.5654,112.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="28.9551" x2="574.5654" y1="112.4297" y2="112.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="35.9551" y="107.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.0449" x="49.0005" y="107.3638">Web Service navigation</text></g><g class="message" data-participant-1="ua" data-participant-2="ve"><polygon fill="#181818" points="960.6948,167.5625,970.6948,171.5625,960.6948,175.5625,964.6948,171.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="590.5654" x2="966.6948" y1="171.5625" y2="171.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="597.5654" y="166.4966">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.8691" x="610.6108" y="166.4966">Request Protected Resource</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1391.0469" x="0" y="200.1289"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1391.0469" y1="200.1289" y2="200.1289"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1391.0469" y1="203.1289" y2="203.1289"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="161.5703" x="614.7383" y="189.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143.0444" x="620.7383" y="205.6294">Presentation Phase</text><g class="message" data-participant-1="ve" data-participant-2="ve"><line style="stroke:#181818;stroke-width:1;" x1="982.6948" x2="1024.6948" y1="258.9609" y2="258.9609"/><line style="stroke:#181818;stroke-width:1;" x1="1024.6948" x2="1024.6948" y1="258.9609" y2="271.9609"/><line style="stroke:#181818;stroke-width:1;" x1="983.6948" x2="1024.6948" y1="271.9609" y2="271.9609"/><polygon fill="#181818" points="993.6948,267.9609,983.6948,271.9609,993.6948,275.9609,989.6948,271.9609" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="989.6948" y="246.3286">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.2852" x="1002.7402" y="238.7622">Create a state value</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.1753" x="1002.7402" y="253.895">bound to user-agent cookie</text></g><g class="message" data-participant-1="ve" data-participant-2="ve"><line style="stroke:#181818;stroke-width:1;" x1="982.6948" x2="1024.6948" y1="301.0938" y2="301.0938"/><line style="stroke:#181818;stroke-width:1;" x1="1024.6948" x2="1024.6948" y1="301.0938" y2="314.0938"/><line style="stroke:#181818;stroke-width:1;" x1="983.6948" x2="1024.6948" y1="314.0938" y2="314.0938"/><polygon fill="#181818" points="993.6948,310.0938,983.6948,314.0938,993.6948,318.0938,989.6948,314.0938" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="989.6948" y="296.0278">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.9429" x="1002.7402" y="296.0278">Create request_uri resource</text></g><g class="message" data-participant-1="ve" data-participant-2="ve"><line style="stroke:#181818;stroke-width:1;" x1="982.6948" x2="1024.6948" y1="358.3594" y2="358.3594"/><line style="stroke:#181818;stroke-width:1;" x1="1024.6948" x2="1024.6948" y1="358.3594" y2="371.3594"/><line style="stroke:#181818;stroke-width:1;" x1="983.6948" x2="1024.6948" y1="371.3594" y2="371.3594"/><polygon fill="#181818" points="993.6948,367.3594,983.6948,371.3594,993.6948,375.3594,989.6948,371.3594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="989.6948" y="345.7271">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.2446" x="1002.7402" y="338.1606">Inspect user-agent type</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.5269" x="1002.7402" y="353.2935">to detect cross device or same device</text></g><g class="message" data-participant-1="ve" data-participant-2="ua"><polygon fill="#181818" points="601.5654,411.625,591.5654,415.625,601.5654,419.625,597.5654,415.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="595.5654" x2="976.6948" y1="415.625" y2="415.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="607.5654" y="402.9927">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="345.084" x="620.6108" y="395.4263">html page with QRCode or href containig the url with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325.438" x="620.6108" y="410.5591">client_id, request_uri, state, [request_uri_method]</text></g><g class="message" data-participant-1="ua" data-participant-2="u"><polygon fill="#181818" points="34.9551,440.7578,24.9551,444.7578,34.9551,448.7578,30.9551,444.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="28.9551" x2="584.5654" y1="444.7578" y2="444.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="40.9551" y="439.6919">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307.2012" x="54.0005" y="439.6919">Show the QRCode page or click the href button</text></g><path d="M161.1709,459.7578 L335.7583,459.7578 L335.7583,466.8906 L325.7583,476.8906 L161.1709,476.8906 L161.1709,459.7578" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="59.2656" style="stroke:#000000;stroke-width:1.5;" width="210.6118" x="161.1709" y="459.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="129.5874" x="176.1709" y="472.8247">Cross Device only</text><g class="message" data-participant-1="w" data-participant-2="w"><line style="stroke:#181818;stroke-width:1;" x1="237.3218" x2="279.3218" y1="498.0234" y2="498.0234"/><line style="stroke:#181818;stroke-width:1;" x1="279.3218" x2="279.3218" y1="498.0234" y2="511.0234"/><line style="stroke:#181818;stroke-width:1;" x1="238.3218" x2="279.3218" y1="511.0234" y2="511.0234"/><polygon fill="#181818" points="248.3218,507.0234,238.3218,511.0234,248.3218,515.0234,244.3218,511.0234" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="244.3218" y="492.9575">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.4155" x="257.3672" y="492.9575">Scan QR Code</text></g><g class="message" data-participant-1="u" data-participant-2="w"><polygon fill="#181818" points="215.3218,543.1563,225.3218,547.1563,215.3218,551.1563,219.3218,547.1563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="23.9551" x2="221.3218" y1="547.1563" y2="547.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9.0454" x="30.9551" y="542.0903">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.3213" x="44.0005" y="542.0903">Local User authentication</text></g><g class="message" data-participant-1="w" data-participant-2="w"><line style="stroke:#181818;stroke-width:1;" x1="237.3218" x2="279.3218" y1="576.2891" y2="576.2891"/><line style="stroke:#181818;stroke-width:1;" x1="279.3218" x2="279.3218" y1="576.2891" y2="589.2891"/><line style="stroke:#181818;stroke-width:1;" x1="238.3218" x2="279.3218" y1="589.2891" y2="589.2891"/><polygon fill="#181818" points="248.3218,585.2891,238.3218,589.2891,248.3218,593.2891,244.3218,589.2891" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="244.3218" y="571.2231">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206.8511" x="266.4126" y="571.2231">Evaluate trust with the client_id</text></g><path d="M161.1709,604.2891 L225.6138,604.2891 L225.6138,611.4219 L215.6138,621.4219 L161.1709,621.4219 L161.1709,604.2891" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="132.3359" style="stroke:#000000;stroke-width:1.5;" width="1133.1226" x="161.1709" y="604.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="176.1709" y="617.356">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="250.5293" x="240.6138" y="616.4995">[if request_uri_method is set with POST]</text><g class="message" data-participant-1="w" data-participant-2="ve"><polygon fill="#181818" points="960.6948,638.5547,970.6948,642.5547,960.6948,646.5547,964.6948,642.5547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.3218" x2="966.6948" y1="642.5547" y2="642.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="244.3218" y="637.4888">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="343.0591" x="266.4126" y="637.4888">Provide Wallet metadata to the request_uri endpoint</text></g><g class="message" data-participant-1="ve" data-participant-2="ve"><line style="stroke:#181818;stroke-width:1;" x1="982.6948" x2="1024.6948" y1="671.6875" y2="671.6875"/><line style="stroke:#181818;stroke-width:1;" x1="1024.6948" x2="1024.6948" y1="671.6875" y2="684.6875"/><line style="stroke:#181818;stroke-width:1;" x1="983.6948" x2="1024.6948" y1="684.6875" y2="684.6875"/><polygon fill="#181818" points="993.6948,680.6875,983.6948,684.6875,993.6948,688.6875,989.6948,684.6875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="989.6948" y="666.6216">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260.5078" x="1011.7856" y="666.6216">Evaluate the Wallet tecnical capabilities</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="161.1709" x2="1294.2935" y1="693.6875" y2="693.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="334.7104" x="166.1709" y="703.8979">[if request_uri_method is set with GET or not present]</text><g class="message" data-participant-1="w" data-participant-2="ve"><polygon fill="#181818" points="960.6948,724.625,970.6948,728.625,960.6948,732.625,964.6948,728.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.3218" x2="966.6948" y1="728.625" y2="728.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="244.3218" y="723.5591">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="423.5854" x="266.4126" y="723.5591">Request the signed request object from the request_uri endpoint</text></g><g class="message" data-participant-1="ve" data-participant-2="w"><polygon fill="#181818" points="248.3218,760.7578,238.3218,764.7578,248.3218,768.7578,244.3218,764.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.3218" x2="976.6948" y1="764.7578" y2="764.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="254.3218" y="759.6919">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.1528" x="276.4126" y="759.6919">signed request object</text></g><g class="message" data-participant-1="w" data-participant-2="w"><line style="stroke:#181818;stroke-width:1;" x1="237.3218" x2="279.3218" y1="793.8906" y2="793.8906"/><line style="stroke:#181818;stroke-width:1;" x1="279.3218" x2="279.3218" y1="793.8906" y2="806.8906"/><line style="stroke:#181818;stroke-width:1;" x1="238.3218" x2="279.3218" y1="806.8906" y2="806.8906"/><polygon fill="#181818" points="248.3218,802.8906,238.3218,806.8906,248.3218,810.8906,244.3218,806.8906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="244.3218" y="788.8247">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.8042" x="266.4126" y="788.8247">Evaluate Relying Party Metadata and policies</text></g><g class="message" data-participant-1="w" data-participant-2="w"><line style="stroke:#181818;stroke-width:1;" x1="237.3218" x2="279.3218" y1="836.0234" y2="836.0234"/><line style="stroke:#181818;stroke-width:1;" x1="279.3218" x2="279.3218" y1="836.0234" y2="849.0234"/><line style="stroke:#181818;stroke-width:1;" x1="238.3218" x2="279.3218" y1="849.0234" y2="849.0234"/><polygon fill="#181818" points="248.3218,845.0234,238.3218,849.0234,248.3218,853.0234,244.3218,849.0234" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="244.3218" y="830.9575">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297.1528" x="266.4126" y="830.9575">Verify signature of the signed Request Object</text></g><g class="message" data-participant-1="w" data-participant-2="w"><line style="stroke:#181818;stroke-width:1;" x1="237.3218" x2="279.3218" y1="878.1563" y2="878.1563"/><line style="stroke:#181818;stroke-width:1;" x1="279.3218" x2="279.3218" y1="878.1563" y2="891.1563"/><line style="stroke:#181818;stroke-width:1;" x1="238.3218" x2="279.3218" y1="891.1563" y2="891.1563"/><polygon fill="#181818" points="248.3218,887.1563,238.3218,891.1563,248.3218,895.1563,244.3218,891.1563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="244.3218" y="873.0903">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.2622" x="266.4126" y="873.0903">Validate requested VP(s)</text></g><g class="message" data-participant-1="w" data-participant-2="u"><polygon fill="#181818" points="39.9551,916.2891,29.9551,920.2891,39.9551,924.2891,35.9551,920.2891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="33.9551" x2="226.3218" y1="920.2891" y2="920.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="45.9551" y="915.2231">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.9775" x="68.0459" y="915.2231">Request for consent</text></g><g class="message" data-participant-1="u" data-participant-2="w"><polygon fill="#181818" points="215.3218,945.4219,225.3218,949.4219,215.3218,953.4219,219.3218,949.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="23.9551" x2="221.3218" y1="949.4219" y2="949.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="30.9551" y="944.356">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.7168" x="53.0459" y="944.356">Confirmed</text></g><g class="message" data-participant-1="w" data-participant-2="ve"><polygon fill="#181818" points="960.6948,989.6875,970.6948,993.6875,960.6948,997.6875,964.6948,993.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.3218" x2="966.6948" y1="993.6875" y2="993.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="244.3218" y="981.0552">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.6196" x="266.4126" y="973.4888">POST Authorization Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302.396" x="270.5449" y="988.6216">with vp_token, state, presentation_submission</text></g><g class="message" data-participant-1="ve" data-participant-2="ve"><line style="stroke:#181818;stroke-width:1;" x1="982.6948" x2="1024.6948" y1="1022.8203" y2="1022.8203"/><line style="stroke:#181818;stroke-width:1;" x1="1024.6948" x2="1024.6948" y1="1022.8203" y2="1035.8203"/><line style="stroke:#181818;stroke-width:1;" x1="983.6948" x2="1024.6948" y1="1035.8203" y2="1035.8203"/><polygon fill="#181818" points="993.6948,1031.8203,983.6948,1035.8203,993.6948,1039.8203,989.6948,1035.8203" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="989.6948" y="1017.7544">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.4883" x="1011.7856" y="1017.7544">Evaluate the Verifiable Presentation token</text></g><g class="message" data-participant-1="ve" data-participant-2="ve"><line style="stroke:#181818;stroke-width:1;" x1="982.6948" x2="1024.6948" y1="1110.3516" y2="1110.3516"/><line style="stroke:#181818;stroke-width:1;" x1="1024.6948" x2="1024.6948" y1="1110.3516" y2="1123.3516"/><line style="stroke:#181818;stroke-width:1;" x1="983.6948" x2="1024.6948" y1="1123.3516" y2="1123.3516"/><polygon fill="#181818" points="993.6948,1119.3516,983.6948,1123.3516,993.6948,1127.3516,989.6948,1123.3516" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="989.6948" y="1082.5864">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.2231" x="1011.7856" y="1059.8872">Validate the Wallet Attestation.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.8638" x="1011.7856" y="1075.02">Attest the Wallet Provider</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.3774" x="1015.918" y="1090.1528">is part of the Federation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.5947" x="1015.918" y="1105.2856">and the Wallet Instance is not revoked.</text></g><g class="message" data-participant-1="ve" data-participant-2="ve"><line style="stroke:#181818;stroke-width:1;" x1="982.6948" x2="1024.6948" y1="1167.6172" y2="1167.6172"/><line style="stroke:#181818;stroke-width:1;" x1="1024.6948" x2="1024.6948" y1="1167.6172" y2="1180.6172"/><line style="stroke:#181818;stroke-width:1;" x1="983.6948" x2="1024.6948" y1="1180.6172" y2="1180.6172"/><polygon fill="#181818" points="993.6948,1176.6172,983.6948,1180.6172,993.6948,1184.6172,989.6948,1180.6172" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="989.6948" y="1154.9849">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.9058" x="1011.7856" y="1147.4185">Attest Credential Issuer Trust</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.8804" x="1015.918" y="1162.5513">and Validate JWT Signature</text></g><g class="message" data-participant-1="ve" data-participant-2="ve"><line style="stroke:#181818;stroke-width:1;" x1="982.6948" x2="1024.6948" y1="1209.75" y2="1209.75"/><line style="stroke:#181818;stroke-width:1;" x1="1024.6948" x2="1024.6948" y1="1209.75" y2="1222.75"/><line style="stroke:#181818;stroke-width:1;" x1="983.6948" x2="1024.6948" y1="1222.75" y2="1222.75"/><polygon fill="#181818" points="993.6948,1218.75,983.6948,1222.75,993.6948,1226.75,989.6948,1222.75" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="989.6948" y="1204.6841">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6948" x="1011.7856" y="1204.6841">Process the credential</text></g><rect fill="#90EE90" height="83" style="stroke:#181818;stroke-width:0.5;" width="537" x="708" y="1235.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.0747" x="712" y="1251.8169">Process the credential:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374.6069" x="716.1323" y="1266.9497">- Check Holder Key Binding and Proof of Possession using</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="399.4263" x="724.397" y="1282.0825">the public key bound in the Credential to verify the VP token.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="712" y="1297.2153">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="525.8271" x="716.1323" y="1312.3481">- Extract the disclosed attributes and check if all the required data are available.</text><g class="message" data-participant-1="ve" data-participant-2="ve"><line style="stroke:#181818;stroke-width:1;" x1="982.6948" x2="1024.6948" y1="1345.5469" y2="1345.5469"/><line style="stroke:#181818;stroke-width:1;" x1="1024.6948" x2="1024.6948" y1="1345.5469" y2="1358.5469"/><line style="stroke:#181818;stroke-width:1;" x1="983.6948" x2="1024.6948" y1="1358.5469" y2="1358.5469"/><polygon fill="#181818" points="993.6948,1354.5469,983.6948,1358.5469,993.6948,1362.5469,989.6948,1358.5469" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="989.6948" y="1340.481">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.2222" x="1011.7856" y="1340.481">Update the User session (cookie updated)</text></g><path d="M161.1709,1373.5469 L426.0029,1373.5469 L426.0029,1380.6797 L416.0029,1390.6797 L161.1709,1390.6797 L161.1709,1373.5469" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="90.5313" style="stroke:#000000;stroke-width:1.5;" width="883.3921" x="161.1709" y="1373.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="219.832" x="176.1709" y="1386.6138">Same Device with redirect_uri</text><g class="message" data-participant-1="ve" data-participant-2="w"><polygon fill="#181818" points="248.3218,1422.9453,238.3218,1426.9453,248.3218,1430.9453,244.3218,1426.9453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.3218" x2="971.6948" y1="1426.9453" y2="1426.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="254.3218" y="1414.313">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.3857" x="276.4126" y="1406.7466">HTTP/1.1 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303.4497" x="280.5449" y="1421.8794">{"redirect_uri": https url with response_code }</text></g><g class="message" data-participant-1="w" data-participant-2="ua"><polygon fill="#181818" points="568.5654,1452.0781,578.5654,1456.0781,568.5654,1460.0781,572.5654,1456.0781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.3218" x2="574.5654" y1="1456.0781" y2="1456.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="244.3218" y="1451.0122">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.375" x="266.4126" y="1451.0122">Use the redirect_uri</text></g><path d="M161.1709,1478.0781 L568.7427,1478.0781 L568.7427,1485.2109 L558.7427,1495.2109 L161.1709,1495.2109 L161.1709,1478.0781" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="134.7969" style="stroke:#000000;stroke-width:1.5;" width="1219.876" x="161.1709" y="1478.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="362.5718" x="176.1709" y="1491.145">Cross Device or Same Device without redirect_uri</text><g class="message" data-participant-1="ve" data-participant-2="w"><polygon fill="#181818" points="243.3218,1512.3438,233.3218,1516.3438,243.3218,1520.3438,239.3218,1516.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="237.3218" x2="976.6948" y1="1516.3438" y2="1516.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="249.3218" y="1511.2778">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.3857" x="271.4126" y="1511.2778">HTTP/1.1 200 OK</text></g><g class="message" data-participant-1="ua" data-participant-2="se"><polygon fill="#181818" points="1292.2739,1556.6094,1302.2739,1560.6094,1292.2739,1564.6094,1296.2739,1560.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="590.5654" x2="1298.2739" y1="1560.6094" y2="1560.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="597.5654" y="1547.9771">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.438" x="619.6563" y="1540.4106">JavaScript check: authentication state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.5127" x="623.7886" y="1555.5435">(HTTP request with cookie)</text></g><g class="message" data-participant-1="se" data-participant-2="ua"><polygon fill="#181818" points="601.5654,1600.875,591.5654,1604.875,601.5654,1608.875,597.5654,1604.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="595.5654" x2="1308.2739" y1="1604.875" y2="1604.875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="607.5654" y="1592.2427">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.3857" x="629.6563" y="1584.6763">HTTP/1.1 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299.3174" x="633.7886" y="1599.8091">{"redirect_uri": https url with response_code}</text></g><g class="message" data-participant-1="ua" data-participant-2="ve"><polygon fill="#181818" points="960.6948,1637.0078,970.6948,1641.0078,960.6948,1645.0078,964.6948,1641.0078" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="590.5654" x2="966.6948" y1="1641.0078" y2="1641.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="597.5654" y="1635.9419">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.3354" x="619.6563" y="1635.9419">Redirect to the protected resource</text></g><g class="message" data-participant-1="ve" data-participant-2="ua"><polygon fill="#181818" points="596.5654,1666.1406,586.5654,1670.1406,596.5654,1674.1406,592.5654,1670.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="590.5654" x2="976.6948" y1="1670.1406" y2="1670.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18.0908" x="602.5654" y="1665.0747">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123.6587" x="624.6563" y="1665.0747">Protected resource</text></g><!--SRC=[fLPHRzis47xdhpYu3qk096lt6203qZHBqdQB5xlDmp8Oj4JRN6HI8ocxtj3_lkz8IQQI51kmm0yHnRlxxhllxYIRO4spdYidX3WlWdKq-kIL6v7qr0Wnjr_ImNUUtgcDBfGVqQkFUhaARwj6YLgwe0jTInDeT2-hIWMwCJv8KwZeOpkyqi3LiLmg4r84APGf2L7QK7Ugsccpf36CTj-EDBZsO0vkpvkmeejAm_5XzBnvOW58eV64QBNLRNIlzj65a4NG6naKqcxe-4TWEwLxDQU9Sfmt6RdHIncqDTbLAKgL6qgstAXJkbD_Die76ZiRL15KYHDl6rSe8SxESAmyi4PtD5v9h-ZiREyNw3UgStNX59z9uXpmJeAE1pEt3R07ItjAgR3sKRzWwXAOMUCq_czXx6-XO3Kmvfx2haOCU2yLmwV2MU_n49c0IBnSg_QnTSHqhSAweXeUQAjHZr_lBcmPhw-SMW0T4jP6BociG9Qhugq7KyIopNHvb0CzIkaUqM_PuMojmigMl-UiWolH4j-SqcHbjz5_6poY0G84AHxZYuXbtWG8Vr0ykQT_AyJIsQO6VvpskpPjK-t4bkDi4QUG1Z68Wx2A18iclVfe2raHDmr9o1AvwIBffhU-v29ofE0QY2IonTXwAY37Af1UqFFaIRDoMwFnxMGg27_RhfWGt4OZyROPOIDB6IGhXIFaKkYQ8Jh8-UJdlJpsO5UzMuZ2Q4wpaBMSwqe7hRnG5NJyxw2lBgTS4cC3rQaFH9v1rpeSpkkbGU-q3idE_s0rBfnTVpkRM0s6dxX-qSKp0Jshp634qCyTZH9DLrk8YVFjZ3uhfnUx60bJna4gYnnzbz1j2jrRoKgNMNlYvkVnWJzC5vez4GlMhpMHgE6KIeukh5bejrRbS1Zj9G6H44z8w_HVQUHW6DNiaHvCgiccdWNxg4pVTdKseMQ-cQ-rzuFPDvXH0ur4EhISLseuvsA0pAWd81FMUGZAf_id09SUymkjlXs0GrCyupksVr8uZfPuntNAhBgTn3QiEwSs05EUP6ZQK1YP9RSij7tZVOCcddAFjYvxoE_lfpJfwfrv0JpiI9-wkNSbX4DKw683VxZywkFDrVNqwkxoyXVniiMfe6EwM2aChMjR8J7we7RqLfkIHSbGO8V4yHjZHgbO74nmValSJkokRkPGAZt2CgqBRU9vbYF6mYQfDrPkd8fq8ZZyvPVWKExufjI-gAo7HcK8JcD-AXzX514ZcXv4zpsf4O1Ilw0Rv4RgYkLmmhqPcH0PPP_gNWHnQ7R97AHrHaryNnwARYfFUFcqGpcA5z4GiOXp8Elyw-bq_FsRapVqm-lNTFi19Vnxb5yTySOAjUzt4I_7s1QpWdV7rxOJiTa0h4qkYvJlZZXqNbeQxXbSsuJ_Y3Zlv-sJaPKsdWT_z1u4Jmgdwv2gSVfaxxGV3iZ_W0Fqep2cd4W-t2U3hoAV077Y_vF3hoA73TU9gC67KdBMBQYw_s3glrIUZfmMslZvpISBVS3OFm00]--></g></svg>